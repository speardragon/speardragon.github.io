I"r±<p><br /></p>

<h1 id="81-ì‰˜ê³¼-í”„ë¡œì„¸ìŠ¤">8.1 ì‰˜ê³¼ í”„ë¡œì„¸ìŠ¤</h1>

<h2 id="ì‰˜shellì´ë€-ë¬´ì—‡ì¸ê°€">ì‰˜(Shell)ì´ë€ ë¬´ì—‡ì¸ê°€?</h2>

<ul>
  <li>ì‰˜ì˜ ì—­í• 
    <ul>
      <li>ì‰˜ì€ ì‚¬ìš©ìì™€ ìš´ì˜ì²´ì œ ì‚¬ì´ì— ì°½êµ¬ ì—­í• ì„ í•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´
        <ul>
          <li>interface ì—­í• </li>
        </ul>
      </li>
      <li>ëª…ë ¹ì–´ ì²˜ë¦¬ê¸°(command processor)</li>
      <li>ì‚¬ìš©ìë¡œë¶€í„° ëª…ë ¹ì–´ë¥¼ ì…ë ¥ë°›ì•„ ì´ë¥¼ ì²˜ë¦¬í•œë‹¤</li>
      <li>ëª…ë ¹ì–´(í”„ë¡œê·¸ë¨)ê°€ í”„ë¡œì„¸ìŠ¤ê°€ ë¨.</li>
    </ul>
  </li>
</ul>

<p><img src="https://user-images.githubusercontent.com/79521972/167346442-00facc52-347b-42d8-9208-7fa7d685af12.png" alt="image" /></p>

<p><br /></p>

<h2 id="ì‰˜shellì˜-ì¢…ë¥˜">ì‰˜(Shell)ì˜ ì¢…ë¥˜</h2>

<ul>
  <li>Bourne shell
    <ul>
      <li>ìœ ë‹‰ìŠ¤ìš© ìµœì´ˆì˜ ì‰˜</li>
    </ul>
  </li>
  <li>C shell</li>
  <li>Korn shell</li>
  <li>bash shell
    <ul>
      <li>ë¦¬ëˆ…ìŠ¤ì˜ ê¸°ë³¸ ì‰˜</li>
      <li>Bourne shellì„ ê¸°ë°˜ìœ¼ë¡œ ê°œë°œ</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="ì‰˜ì˜-ì§„í–‰-ì ˆì°¨">ì‰˜ì˜ ì§„í–‰ ì ˆì°¨</h2>

<p><img src="https://user-images.githubusercontent.com/79521972/167346426-23e33a98-4629-487b-be3d-c008fc649516.png" alt="image" /></p>

<p><br /></p>

<h2 id="ì‹œì‘-íŒŒì¼">ì‹œì‘ íŒŒì¼</h2>

<ul>
  <li>í™˜ê²½ë³€ìˆ˜ì™€ ê°™ì€ ì‚¬ìš©ìì˜ ì‚¬ìš©í™˜ê²½ì„ ì´ˆê¸°í™”í•˜ëŠ”ë° ì‚¬ìš©</li>
  <li>ì‹œì‘ íŒŒì¼ì˜ ìœ„ì¹˜ (bash)
    <ul>
      <li>ì‹œìŠ¤í…œ : /etc/profile               /etc/bashrc</li>
      <li>ì‚¬ìš©ì : ~/. bash_profile       ~/. bashrc</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="ì‰˜ì˜-êµ¬ì¡°">ì‰˜ì˜ êµ¬ì¡°</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">While</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
     <span class="n">display</span> <span class="n">prompt</span>
     <span class="n">read</span> <span class="n">command</span> <span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span> <span class="c1">// Get command or execution file</span>
     <span class="k">if</span> <span class="p">(</span><span class="n">fork</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">then</span> <span class="p">{</span> <span class="c1">// Execute command or execution file</span>
         <span class="n">wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">status</span><span class="p">);</span> <span class="c1">// fork a child, wait for a child to finish</span>
         <span class="n">exit</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">else</span>
        <span class="n">execve</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">parmas</span><span class="p">)</span> <span class="c1">// ìì‹ í”„ë¡œì„¸ìŠ¤</span>
<span class="p">}</span> <span class="c1">// ì…ë ¥ëœ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls</span>
<span class="nb">.</span> 	.. 	/etc
/home 	/usr 	/dev
<span class="nv">$ </span>a.out
â€¦.
<span class="err">$</span>
</code></pre></div></div>

<p>childì˜ forkì˜ return ê°’ì€ 0</p>

<p>ì‰˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ì„œ shell process ìì²´ê°€ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ child processë¥¼ ë§Œë“¤ì–´ child processê°€ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ë‹¤.</p>

<p>ì´ˆê¸°ì— forkë¥¼ í•˜ë©´ parentì™€ ì™„ì „íˆ ë˜‘ê°™ì€ í”„ë¡œì„¸ìŠ¤ê°€ ì‹¤í–‰ë˜ëŠ”ë°</p>

<p>ìì‹ í”„ë¡œì„¸ìŠ¤ëŠ” execve() ì‹œìŠ¤í…œ ì½œì„ í†µí•´ ìì‹ í”„ë¡œì„¸ìŠ¤ì˜ ì´ë¯¸ì§€ê°€ ê·¸ ì „ ì´ë¯¸ì§€ëŠ” ì§€ì›Œë²„ë¦¬ê³  ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ ì´ë¯¸ì§€ë¥¼ ê°–ê²Œ ëœë‹¤.</p>

<p><br /></p>

<h2 id="shell-ë³µí•©-ëª…ë ¹ì–´">Shell ë³µí•© ëª…ë ¹ì–´</h2>

<ul>
  <li><strong>ëª…ë ¹ì–´ ì—´(command sequence)</strong>
    <ul>
      <li>$ ëª…ë ¹ì–´1; â€¦ ; ëª…ë ¹ì–´n</li>
      <li>$ date; who; pwd</li>
    </ul>
  </li>
  <li><strong>ëª…ë ¹ì–´ ê·¸ë£¹(command group)</strong>
    <ul>
      <li>ê·¸ë£¹ ë‚´ <strong>ëª¨ë“  ëª…ë ¹ì–´ë“¤ì´</strong> stdin, stdout, stderr <strong>ê³µìœ </strong></li>
      <li>$ (ëª…ë ¹ì–´1; â€¦ ; ëª…ë ¹ì–´n)</li>
      <li>$ date; who; pwd &gt; out1.txt // pwdì˜ ê²°ê³¼ë§Œ out1.txtë¡œ ì¶œë ¥</li>
      <li>$ (date; who; pwd) &gt; out2.txt // date, who, pwd ì˜ ê²°ê³¼ê°€ ëª¨ë‘ out2.txtë¡œ ì¶œë ¥</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="ì „ë©´-ì²˜ë¦¬-vs-í›„ë©´-ì²˜ë¦¬">ì „ë©´ ì²˜ë¦¬ vs í›„ë©´ ì²˜ë¦¬</h2>

<ul>
  <li><strong>ì „ë©´ ì²˜ë¦¬</strong>
    <ul>
      <li>ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´ ëª…ë ¹ì–´ê°€ ì „ë©´ì—ì„œ ì‹¤í–‰ë˜ë©° ëª…ë ¹ì–´ ì‹¤í–‰ì´ ëë‚  ë•Œ ê¹Œì§€ ì‰˜ì´ ê¸°ë‹¤ë ¤ ì¤€ë‹¤.
        <ul>
          <li>ì „ë©´ -&gt; ì‚¬ìš©ìê°€ ëª¨ë‹ˆí„°ë¡œ ë³¼ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸.</li>
        </ul>
      </li>
      <li>stdin, stdoutì„ ì´ìš©í•œ ì…ì¶œë ¥ ê°€ëŠ¥</li>
      <li>í•œ ëª…ë ¹ì–´ì”©ë§Œ ìˆ˜í–‰ ê°€ëŠ¥</li>
      <li>Ctrl-C ì…ë ¥ìœ¼ë¡œ ê°•ì œ ì¢…ë£Œ ê°€ëŠ¥,</li>
      <li>Ctrl-Z ì…ë ¥ìœ¼ë¡œ ì‹¤í–‰ ì¤‘ë‹¨ ê°€ëŠ¥, ì¤‘ë‹¨ëœ ëª…ë ¹ì–´ëŠ” fg ëª…ë ¹ì–´ì— ì˜í•´ ë‹¤ì‹œ ì „ë©´ ì²˜ë¦¬ ê³„ì†ë¨</li>
    </ul>
  </li>
  <li><strong>í›„ë©´ ì²˜ë¦¬</strong>
    <ul>
      <li>ëª…ë ¹ì–´ë“¤ì„ í›„ë©´ì—ì„œ ì²˜ë¦¬í•˜ê³  ì ‚ë©´ì—ì„œëŠ” ë‹¤ë¥¸ ì‘ì—…ì„ í•  ìˆ˜ ìˆìœ¼ë©´ ë™ ì‹œì— ì—¬ëŸ¬ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.</li>
      <li>$ ëª…ë ¹ì–´ &amp;</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="í›„ë©´-ì²˜ë¦¬-ì˜ˆ">í›„ë©´ ì²˜ë¦¬ ì˜ˆ</h2>

<ul>
  <li>$ (sleep 100; echo done) &amp; // 2 ê°œì˜ í›„ë©´ ì‘ì—… ìƒì„± 
[1] 8320</li>
  <li>$ find . -name test.c -print &amp; 
[2] 8325</li>
  <li>$ jobs // í›„ë©´ ì‘ì—… ë¦¬ìŠ¤íŠ¸ 
[1] + Running ( sleep 100; echo done )
[2] - Running find . -name test.c â€“print</li>
  <li><strong>$ fg %ì‘ì—…ë²ˆí˜¸ // í›„ë©´ ì‘ì—…ì„ ì „ë©´ ì‘ì—…ìœ¼ë¡œ ì „í™˜</strong> 
$ fg %1 
( sleep 100; echo done )
    <ul>
      <li>fg %job_num</li>
    </ul>
  </li>
  <li>í›„ë©´ì²˜ë¦¬ ì…ì¶œë ¥ : í”„ë¦°íŠ¸ ê²°ê³¼ ë’¤ì„ì„ ë°©ì§€ ëª©ì  
$ find . -name test.c -print &gt; find.txt &amp; // ì¶œë ¥ ì¬ ì§€ì •, í”„ë¦°íŠ¸ ê²°ê³¼ ë’¤ì„ì„ ë°©ì§€ ëª©ì  (ì „ë©´ê³¼ ë’¤ì„ì´ì§€ ì•Šë„ë¡)
$ find . -name test.c -print | mail chang &amp; 
$ wc &lt; inputfile &amp; // í›„ë©´ í”„ë¡œì„¸ìŠ¤ì˜ ì…ë ¥ ì¬ ì§€ì •ì„ í†µí•œ ì…ë ¥ ì²˜ë¦¬</li>
</ul>

<p><br /></p>

<h2 id="í”„ë¡œì„¸ìŠ¤process">í”„ë¡œì„¸ìŠ¤(process)</h2>

<ul>
  <li>ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œê·¸ë¨ì„ <strong>í”„ë¡œì„¸ìŠ¤</strong>(process)ë¼ê³  ë¶€ë¥¸ë‹¤.</li>
  <li>ê° í”„ë¡œì„¸ìŠ¤ëŠ” ìœ ì¼í•œ í”„ë¡œì„¸ìŠ¤ ë²ˆí˜¸ PIDë¥¼ ê°–ëŠ”ë‹¤.</li>
  <li>ps ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë“¤ì„ ë³¼ ìˆ˜ ìˆë‹¤.</li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ps <span class="c"># ìì‹ ì˜ í”„ë¡œì„¸ìŠ¤ë“¤ì˜ ì‹¤í–‰ ìƒíƒœ ì¶œë ¥</span>
PID TTY TIME CMD
8695 pts/3 00:00:00 csh
8720 pts/3 00:00:00 ps
<span class="nv">$ </span>ps u <span class="c">#ìì„¸í•œ ì •ë³´ ì¶œë ¥,</span>
USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND
chang 8695 0.0 0.0 5252 1728 pts/3 Ss 11:12 0:00 <span class="nt">-csh</span>
chang 8793 0.0 0.0 4252 940 pts/3 R+ 11:15 0:00 ps u
</code></pre></div></div>

<p><br /></p>

<h2 id="í”„ë¡œì„¸ìŠ¤-ìƒíƒœ-ps">í”„ë¡œì„¸ìŠ¤ ìƒíƒœ: ps</h2>

<ul>
  <li>
    <p>ps [-ì˜µì…˜] ëª…ë ¹ì–´</p>
  </li>
  <li>í˜„ì¬ ì¡´ì¬í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ë“¤ì˜ ì‹¤í–‰ ìƒíƒœë¥¼ <strong>ìš”ì•½í•´ì„œ</strong> ì¶œë ¥
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PID TTY TIME CMD
25435 pts/3 00:00:00 csh
25461 pts/3 00:00:00 ps
</code></pre></div>    </div>
  </li>
  <li>
    <p>$ ps -aux (BSD ìœ ë‹‰ìŠ¤)</p>
  </li>
  <li>- a: ëª¨ë“  ì‚¬ìš©ìì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¶œë ¥</li>
  <li>- u: í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ ì¢€ ë” ìì„¸í•œ ì •ë³´ë¥¼ ì¶œë ¥</li>
  <li>
    <p>- x: ë” ì´ìƒ ì œì–´ í„°ë¯¸ë„ì„ ê°–ì§€ ì•Šì€ í”„ë¡œì„¸ìŠ¤ë“¤ë„ í•¨ê»˜ ì¶œë ¥</p>
  </li>
  <li>$ ps -ef (ì‹œìŠ¤í…œ V)</li>
  <li>- e: ëª¨ë“  ì‚¬ìš©ì í”„ë¡œì„¸ìŠ¤ ì •ë³´ë¥¼ ì¶œë ¥</li>
  <li>- f: í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ ì¢€ ë” ìì„¸í•œ ì •ë³´ë¥¼ ì¶œë ¥</li>
</ul>

<p><br /></p>

<h2 id="ps-aux">ps aux</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ps <span class="nt">-aux</span> //ì‹œìŠ¤í…œ ë‚´ì˜ ëª¨ë“  í”„ë¡œì„¸ìŠ¤ ì •ë³´ ì¶œë ¥
Or
<span class="nv">$ </span>ps <span class="nt">-ef</span>
USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND
root 1 0.0 0.0 2064 652 ? Ss 2011 0:27 init <span class="o">[</span>5]
root 2 0.0 0.0 0 0 ? S&lt; 2011 0:01 <span class="o">[</span>migration/0]
root 3 0.0 0.0 0 0 ? SN 2011 0:00 <span class="o">[</span>ksoftirqd/0]
root 4 0.0 0.0 0 0 ? S&lt; 2011 0:00 <span class="o">[</span>watchdog/0]
...
root 8692 0.0 0.1 9980 2772 ? Ss 11:12 0:00 sshd: chang <span class="o">[</span><span class="nb">pr
</span>chang 8694 0.0 0.0 9980 1564 ? R 11:12 0:00 sshd: chang@pts
chang 8695 0.0 0.0 5252 1728 pts/3 Ss 11:12 0:00 <span class="nt">-csh</span>
chang 8976 0.0 0.0 4252 940 pts/3 R+ 11:24 0:00 ps aux
</code></pre></div></div>

<p><br /></p>

<h2 id="í”„ë¡œì„¸ìŠ¤process-1">í”„ë¡œì„¸ìŠ¤(process)</h2>

<ul>
  <li>processes are <strong>the most fundamental abstraction</strong> in a Unix system, after files.</li>
  <li>As object code in execution
    <ul>
      <li>active, alive, running programs</li>
      <li>processes are more than just assembly language;
        <ul>
          <li>they consist of data, resources, state, and a virtualized computer</li>
        </ul>
      </li>
      <li>program image + environment
        <ul>
          <li>text(code) /data / stack / heap segment</li>
          <li>kernel data structure(PCB), address space, open files, â€¦</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h3 id="process">Process</h3>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/* test_program.c */</span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">glob_var</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">test_func</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">local_var</span><span class="p">,</span> <span class="o">*</span><span class="n">buf</span><span class="p">;</span>

    <span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mo">000</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">));</span>
    <span class="err">â€¦</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">local_var</span><span class="p">;</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"value of a = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
    <span class="n">test_func</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>gcc â€“o test_program test_program.c
</code></pre></div></div>

<p>ë§Œë“¤ì–´ì§€ëŠ” test_program ì‹¤í–‰ íŒŒì¼ì„ program definitionì´ë¼ê³  í•˜ê³  ì´ê²ƒì„ ì‹¤í–‰ì‹œì¼°ì„ ë•Œ ë‚˜ì˜¤ëŠ” instanceë¥¼ processë¼ê³  í•œë‹¤.</p>

<p><br /></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./test_program
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/79521972/167347246-2c9123b1-7edd-43d1-9a36-7bfcfbcd5003.png" alt="image" /></p>

<ul>
  <li>* bss: Block Started by Symbol</li>
  <li>PCB: Process Control Block</li>
  <li>í”„ë¡œê·¸ë¨(or definition): í•˜ë“œë””ìŠ¤í¬ì— program imageë¡œ ì €ì¥ ë˜ì–´ ìˆìŒ\</li>
  <li>í”„ë¡œì„¸ìŠ¤:
    <ul>
      <li>ë¹¨ê°„ ë¶€ë¶„ì´ í”„ë¡œê·¸ë¨ì´ ì»´íŒŒì¼í•  ë•Œ ë§Œë“¤ì–´ì§€ëŠ” ë¶€ë¶„ì´ê³  stackê³¼ heap ì˜ì—­ì€ programì—ë„ ì¡´ì¬í•˜ê¸´ í•˜ì§€ë§Œ ì‹¤ì œ ë‚´ìš©ì´ ë§Œë“¤ì–´ì§€ëŠ” ê²ƒì€ processí™” ëœ ì´í›„ì´ë‹¤.</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="sleep">sleep</h2>

<p>shell ëª…ë ¹ì–´ì—ì„œì˜ (sleep, wait, kill) vs. ì‹œìŠ¤í…œ ì½œì—ì„œì˜ (sleep, wait, kill)</p>

<ul>
  <li>ë‘˜ ê°„ì˜ ì°¨ì´ëŠ” shell ëª…ë ¹ì–´ëŠ” prompt ì°½ì—ì„œ ì‹¤í–‰ì„ ì‹œí‚¤ì§€ë§Œ ì‹œìŠ¤í…œ ì½œì€ í”„ë¡œê·¸ë¨ ì•ˆì—ì„œ ì‹¤í–‰ì‹œí‚¨ë‹¤.</li>
</ul>

<p><br /></p>

<ul>
  <li>sleep ëª…ë ¹ì–´
    <ul>
      <li>ì§€ì •ëœ ì‹œê°„ë§Œí¼ ì‹¤í–‰ì„ ì¤‘ì§€í•œë‹¤</li>
    </ul>
  </li>
  <li>
    <p>`	$ sleep ì´ˆ `</p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">$ (echo ì‹œì‘; sleep 5; echo ë)</code></li>
</ul>

<p>sleep ëª…ë ¹ì„ í•˜ë©´ WAITING ìƒíƒœê°€ ë˜ì–´ CPU ì‚¬ìš©ì„ ì¡ì•„ë¨¹ì§€ ì•ŠëŠ”ë‹¤.</p>

<ul>
  <li>ê·¸ë˜ì„œ ì´ ë•Œ ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ ì‹¤í–‰ì„ í•  ìˆ˜ ìˆê²Œ ëœë‹¤.</li>
</ul>

<p>ë©€í‹° í”„ë¡œê·¸ë˜ë°ì´ ì§€ì›ë˜ì§€ ì•Šì•˜ìœ¼ë©´ í”„ë¡œì„¸ìŠ¤ë¼ëŠ” ê°œë…ì´ ì—†ì—ˆì„ ê²ƒì´ë‹¤.</p>

<p><br /></p>

<h2 id="kill">kill</h2>

<ul>
  <li>kill ëª…ë ¹ì–´
    <ul>
      <li>ìˆ˜í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ì— ì‹œê·¸ë„ ë³´ëƒ„</li>
      <li>ì‹œê·¸ë„ ë¯¸ëª…ì‹œì‹œ í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ë¥¼ ê°•ì œë¡œ ì¢…ë£Œ 
$ kill [-ì‹œê·¸ë„] í”„ë¡œì„¸ìŠ¤ë²ˆí˜¸ 
$ kill [-ì‹œê·¸ë„] %ì‘ì—…ë²ˆí˜¸</li>
      <li>ì‹œê·¸ë„ì„ ê¸°ì¬í•˜ì§€ ì•Šì€ ê²½ìš° -&gt; í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì´ í”„ë¡œì„¸ìŠ¤ë¥¼ ê°•ì œë¡œ ì¢…ë£Œë¥¼ ìš”êµ¬í•˜ëŠ” ê²ƒ</li>
    </ul>
  </li>
  <li>$ (echo ì‹œì‘; sleep 5; echo ë) &amp; 
1230 
$ kill 1230</li>
  <li>$ (sleep 100; echo done) &amp; 
[1] 8320</li>
</ul>

<p>â€‹		$ kill 8320 
â€‹		$ kill %1 
â€‹		[1] Terminated ( sleep 100; echo done )</p>

<h2 id="wait">wait</h2>

<p>$ wait [í”„ë¡œì„¸ìŠ¤ë²ˆí˜¸]</p>

<ul>
  <li>
    <p>í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ ë²ˆí˜¸ë¥¼ ê°–ëŠ” ìì‹ í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤. ì‰˜ì€ ì¤‘ì§€</p>
  </li>
  <li>
    <p>í”„ë¡œì„¸ìŠ¤ ë²ˆí˜¸ë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ëª¨ë“  ìì‹ í”„ë¡œì„¸ìŠ¤ë¥¼ ê¸°ë‹¤ë¦°ë‹¤.</p>
  </li>
</ul>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="o">(</span><span class="nb">sleep </span>10<span class="p">;</span> <span class="nb">echo </span>1ë²ˆ ë<span class="o">)</span> &amp;
1231
<span class="nv">$ </span><span class="nb">echo </span>2ë²ˆ ë<span class="p">;</span> <span class="nb">wait </span>1231<span class="p">;</span> <span class="nb">echo </span>3ë²ˆ ë <span class="c"># 1231 í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ 3ë²ˆ ë x</span>
2ë²ˆ ë
1ë²ˆ ë
3ë²ˆ ë
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="o">(</span><span class="nb">sleep </span>10<span class="p">;</span> <span class="nb">echo </span>1ë²ˆ ë<span class="o">)</span> &amp;
<span class="nv">$ </span><span class="o">(</span><span class="nb">sleep </span>10<span class="p">;</span> <span class="nb">echo </span>2ë²ˆ ë<span class="o">)</span> &amp;
<span class="nv">$ </span><span class="nb">echo </span>3ë²ˆ ë<span class="p">;</span> <span class="nb">wait</span><span class="p">;</span> <span class="nb">echo </span>4ë²ˆ ë <span class="c"># wait -&gt; ëª¨ë“  ìì‹ í”„ë¡œì„¸ìŠ¤ ê¸°ë‹¤ë¦¬ê³  4ë²ˆ ë</span>
3ë²ˆ ë
1ë²ˆ ë
2ë²ˆ ë
4ë²ˆ ë
</code></pre></div></div>

<p><br /></p>

<h2 id="exit">exit</h2>

<ul>
  <li>exit
    <ul>
      <li>ì‰˜ì„ ì¢…ë£Œí•˜ê³  ì¢…ë£Œì½”ë“œ(exit code)ì„ ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ì— ì „ë‹¬
<code class="language-plaintext highlighter-rouge">$ exit [ì¢…ë£Œì½”ë“œ]</code></li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h1 id="82-í”„ë¡œê·¸ë¨-ì‹œì‘">8.2 í”„ë¡œê·¸ë¨ ì‹œì‘</h1>

<h2 id="í”„ë¡œê·¸ë¨-ì‹¤í–‰-ì‹œì‘ì¤‘ìš”">í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì‹œì‘(ì¤‘ìš”)</h2>

<ul>
  <li><strong>í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì‹œí‚¤ëŠ” ë°©ë²•</strong>
    <ul>
      <li>ì‰˜ í”„ë¡¬íŠ¸ì—ì„œ ì‹¤í–‰ í•  í”„ë¡œê·¸ë¨ì„ <strong>ì§€ì •</strong>í•˜ì—¬ ì‹¤í–‰ (ì‰˜ì—ì„œ ëª…ë ¹ì–´ ì¹˜ëŠ” ê²ƒ)
        <ul>
          <li>ì‰˜ ëª…ë ¹ì–´ ì´ë¦„ í˜¹ì€ ì‚¬ìš©ìê°€ ì‘ì„±í•œ í”„ë¡œê·¸ë¨ì˜ ì‹¤í–‰ íŒŒì¼ ì´ë¦„</li>
        </ul>
      </li>
      <li>ì‹¤í–‰ ì¤‘ì¸ <strong>í”„ë¡œê·¸ë¨ ì•ˆì—ì„œ</strong> <strong>exec ì‹œìŠ¤í…œì„ í˜¸ì¶œ</strong>í•˜ì—¬ ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ ì‹¤í–‰
        <ul>
          <li>C ì‹œì‘ ë£¨í‹´ì— ëª…ë ¹ì¤„ ì¸ìˆ˜(command-line arguments)ì™€ í™˜ê²½ ë³€ìˆ˜ë¥¼ (environment variables) ì „ë‹¬í•˜ê³  í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì‹œí‚¨ë‹¤.</li>
        </ul>
      </li>
      <li>ê·¼ë³¸ì ìœ¼ë¡œëŠ” ìœ„ ë‘ ê°€ì§€ ë°©ë²•ì´ ê°™ì€ ë°©ì‹</li>
    </ul>
  </li>
  <li>C ì‹œì‘ ë£¨í‹´(start-up routine)
    <ul>
      <li>C í”„ë¡œê·¸ë¨ì„ compile í•˜ë©´, C í”„ë¡œê·¸ë¨ ì½”ë“œì™€ C ì‹œì‘ ë£¨í‹´ì„ í¬í•¨í•˜ëŠ” ì‹¤í–‰íŒŒì¼ ìƒì„±</li>
      <li>Started by the kernel (by the exec system call)</li>
      <li>main í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ì„œ ëª…ë ¹ì¤„ ì¸ìˆ˜, í™˜ê²½ ë³€ìˆ˜ë¥¼ ì „ë‹¬</li>
    </ul>
  </li>
</ul>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">exit</span><span class="p">(</span> <span class="n">main</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">));</span>
</code></pre></div></div>

<p>ì‹¤í–‰ì´ ëë‚˜ë©´ ë°˜í™˜ ê°’ì„ ë°›ì•„ exit í•œë‹¤.</p>

<p><br /></p>

<h2 id="ì‰˜ì˜-êµ¬ì¡°-1">ì‰˜ì˜ êµ¬ì¡°</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">While</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">display</span> <span class="n">prompt</span>
    <span class="n">read</span> <span class="n">command</span> <span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span> <span class="c1">// Get command or execution file</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">fork</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">then</span> <span class="p">{</span> <span class="c1">//Shell process</span>
        <span class="n">wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">status</span><span class="p">);</span> 		<span class="c1">// Execute command or execution file</span>
        <span class="n">exit</span><span class="p">()</span> 				<span class="c1">// fork a child, wait for a child to finish</span>
    <span class="p">}</span>
    <span class="k">else</span>
    	<span class="n">execve</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">parmas</span><span class="p">)</span> <span class="c1">// fork()ì— ì˜í•´ì„œ ìƒì„±ëœ ìì‹ í”„ë¡œì„¸ìŠ¤</span>
<span class="p">}</span> 								<span class="c1">// ì…ë ¥ëœ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls</span>
<span class="nb">.</span> .. /etc
/home /usr /dev
<span class="nv">$ </span>a.out
â€¦.
<span class="err">$</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="í”„ë¡œê·¸ë¨-ì‹¤í–‰-ì‹œì‘ì¤‘ìš”-1">í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì‹œì‘(ì¤‘ìš”**)</h2>

<p><span style="color:red"> ê·¸ë¦¼ ê·¸ë¦´ ì¤„ ì•Œì•„ì•¼ í•¨.</span></p>

<p><img src="https://user-images.githubusercontent.com/79521972/167347783-f0c19d8f-502e-4071-8dec-7172ef1560c2.png" alt="image" /></p>

<p>main í•¨ìˆ˜ì˜ ì¢…ë£Œ ì½”ë“œëŠ” parent processì˜ wait()ìœ¼ë¡œ ì „ë‹¬ë¨</p>

<p><br /></p>

<h2 id="ëª…ë ¹ì¤„-ì¸ìˆ˜í™˜ê²½-ë³€ìˆ˜">ëª…ë ¹ì¤„ ì¸ìˆ˜/í™˜ê²½ ë³€ìˆ˜</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[]);</span>
<span class="c1">//argc : ëª…ë ¹ì¤„ ì¸ìˆ˜ì˜ ê°œìˆ˜</span>
<span class="c1">//argv[] : ëª…ë ¹ì¤„ ì¸ìˆ˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í¬ì¸í„° ë°°ì—´</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/79521972/167347832-452a4ba7-6998-4e97-bddd-4357bc2da3c6.png" alt="image" /></p>

<p>í™˜ê²½ ë³€ìˆ˜ì˜ ê²½ìš°ì— parent processê°€ ìì‹ processë¥¼ ìƒì„±í•˜ëŠ” ê²½ìš°ì— ê·¸ëŒ€ë¡œ ìƒì†ì´ ë˜ëŠ” ê²ƒì´ë‹¤.</p>

<p><br /></p>

<h2 id="argsc">args.c</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cm">/* ëª¨ë“  ëª…ë ¹ì¤„ ì¸ìˆ˜ë¥¼ ì¶œë ¥í•œë‹¤. */</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">argc</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="cm">/* ëª¨ë“  ëª…ë ¹ì¤„ ì¸ìˆ˜ ì¶œë ¥ */</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"argv[%d]: %s </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$args</span> hello world
argv[0]:args
argv[1]:hello
argv[2]:world
</code></pre></div></div>

<p><br /></p>

<h2 id="í™˜ê²½-ë³€ìˆ˜">í™˜ê²½ ë³€ìˆ˜</h2>

<ul>
  <li>í”„ë¡œì„¸ìŠ¤ê°€ ì‹¤í–‰ë˜ëŠ” ê¸°ë³¸ í™˜ê²½ì„ ì„¤ì •í•˜ëŠ” ë³€ìˆ˜</li>
  <li>ë¡œê·¸ì¸ ëª…, ë¡œê·¸ì¸ ì‰˜, í„°ë¯¸ë„ì— ì„¤ì •ëœ ì–¸ì–´, ê²½ë¡œëª… ë“±</li>
  <li>í™˜ê²½ë³€ìˆ˜ëŠ” â€œí™˜ê²½ë³€ìˆ˜=ê°’â€ì˜ í˜•íƒœë¡œ êµ¬ì„±ë˜ë©° ê´€ë¡€ì ìœ¼ë¡œ ëŒ€ë¬¸ìë¡œ ì‚¬ìš©</li>
  <li>í˜„ì¬ ì‰˜ì˜ í™˜ê²½ ì„¤ì •ì„ ë³´ë ¤ë©´ env ëª…ë ¹ì„ ì‚¬ìš©</li>
  <li><strong>ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ì—ì„œ ìì‹ í”„ë¡œì„¸ìŠ¤ë¡œ ì „ë‹¬ëœë‹¤</strong></li>
  <li>.login ë˜ëŠ” .cshrc íŒŒì¼ì—ì„œ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•œë‹¤</li>
  <li>ê° ë¬¸ìì—´ì€ â€˜\0â€™ë¡œ ëë‚œë‹¤</li>
  <li>í™˜ê²½ ë³€ìˆ˜ ë¦¬ìŠ¤íŠ¸ì˜ ë§ˆì§€ë§‰ì€ NULL í¬ì¸í„°</li>
  <li><strong>argv ì™€ ê°™ì€ êµ¬ì¡°</strong>
    <ul>
      <li>ë‹¤ë¥¸ ì ì€?
        <ul>
          <li>ìƒê°í•´ ë³´ê³  ì ì–´ë³´ê¸°</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="environc">environ.c</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cm">/* ì „ì—­ë³€ìˆ˜ environ ì„ ì´ìš©í•´ ëª¨ë“  í™˜ê²½ ë³€ìˆ˜ë¥¼ ì¶œë ¥í•œë‹¤. */</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="kt">char</span> <span class="o">**</span><span class="n">ptr</span><span class="p">;</span> <span class="c1">// local variable, ì´ì¤‘ í¬ì¸í„° </span>
    <span class="k">extern</span> <span class="kt">char</span> <span class="o">**</span><span class="n">environ</span><span class="p">;</span> <span class="c1">// ì „ì—­ ë³€ìˆ˜</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="n">ptr</span> <span class="o">=</span> <span class="n">environ</span><span class="p">;</span> <span class="o">*</span><span class="n">ptr</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ptr</span><span class="o">++</span><span class="p">)</span> <span class="cm">/* ëª¨ë“  í™˜ê²½ ë³€ìˆ˜ ê°’ ì¶œë ¥*/</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"%s </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="o">*</span><span class="n">ptr</span><span class="p">);</span>

    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>environ
HOME <span class="o">=</span> /usr/dddd/ggg
PATH <span class="o">=</span> â€¦
â€¦â€¦â€¦
</code></pre></div></div>

<p>ptrë¡œ ì‹¤ì œ ë‚´ìš©ì„ ì–»ê³  ì‹¶ì€ë° ë‹¨ì¼ í¬ì¸í„°ë¥¼ ì‚¬ìš©í•˜ë©´ ì‹¤ì œ ë‚´ìš©ì´ ë“¤ì–´ìˆëŠ” ì£¼ì†Œê°€ ë“¤ì–´ìˆê¸° ë•Œë¬¸ì— ê·¸ ì£¼ì†Œ ì•ˆì˜ ë‚´ìš©ì„ ì–»ê¸° ìœ„í•´ì„œëŠ” ì´ì¤‘ í¬ì¸í„°ê°€ í•„ìš”í•œ ê²ƒì´ë‹¤.</p>

<p><br /></p>

<h2 id="í™˜ê²½-ë³€ìˆ˜-ì ‘ê·¼">í™˜ê²½ ë³€ìˆ˜ ì ‘ê·¼</h2>

<ul>
  <li>getenv() ì‹œìŠ¤í…œ í˜¸ì¶œì„ ì‚¬ìš©í•˜ì—¬ í™˜ê²½ ë³€ìˆ˜ë¥¼ í•˜ë‚˜ì”© ì ‘ê·¼í•˜ ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤.</li>
</ul>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="kt">char</span> <span class="o">*</span><span class="nf">getenv</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">);</span>
<span class="c1">// í™˜ê²½ ë³€ìˆ˜ name ê°’ì˜ í¬ì¸í„°ë¥¼ ë°˜í™˜í•œë‹¤. í•´ë‹¹ ë³€ìˆ˜ê°€ ì—†ìœ¼ë©´ NULLì„ ë°˜í™˜í•œë‹¤.</span>
<span class="c1">// ì‹¤íŒ¨í•˜ë©´ NULL í¬ì¸í„°ë¥¼ ë¦¬í„´</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="printenvc">printenv.c</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cm">/* í™˜ê²½ ë³€ìˆ˜ë¥¼ 3ê°œ í”„ë¦®íŠ¸í•œë‹¤. */</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
     <span class="kt">char</span> <span class="o">*</span><span class="n">ptr</span><span class="p">;</span>
    
     <span class="n">ptr</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span><span class="s">"HOME"</span><span class="p">);</span>
     <span class="n">printf</span><span class="p">(</span><span class="s">"HOME = %s </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ptr</span><span class="p">);</span>
    
     <span class="n">ptr</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span><span class="s">"SHELL"</span><span class="p">);</span>
     <span class="n">printf</span><span class="p">(</span><span class="s">"SHELL = %s </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ptr</span><span class="p">);</span> 
    
     <span class="n">ptr</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span><span class="s">"PATH"</span><span class="p">);</span> 
     <span class="n">printf</span><span class="p">(</span><span class="s">"PATH = %s </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ptr</span><span class="p">);</span> 
    
     <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">printenv
 </span>HOME <span class="o">=</span>
 ptr <span class="o">=</span> /bin/bash
 PATH <span class="o">=</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="í™˜ê²½-ë³€ìˆ˜-ì„¤ì •">í™˜ê²½ ë³€ìˆ˜ ì„¤ì •</h2>

<ul>
  <li>putenv(), setenv()ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•œë‹¤.</li>
</ul>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="kt">int</span> <span class="nf">putenv</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">);</span>
<span class="c1">// name=value í˜•íƒœì˜ ìŠ¤íŠ¸ë§ì„ ë°›ì•„ì„œ ì´ë¥¼ í™˜ê²½ ë³€ìˆ˜ ë¦¬ìŠ¤íŠ¸ì— ë„£ì–´ì¤€ë‹¤.</span>
<span class="c1">// nameì´ ì´ë¯¸ ì¡´ì¬í•˜ë©´ ì›ë˜ ê°’ì„ ìƒˆë¡œìš´ ê°’ìœ¼ë¡œ ëŒ€ì²´í•œë‹¤.</span>
<span class="kt">int</span> <span class="nf">setenv</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">value</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rewrite</span><span class="p">);</span>
<span class="c1">// í™˜ê²½ ë³€ìˆ˜ nameì˜ ê°’ì„ valueë¡œ ì„¤ì •í•œë‹¤. nameì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ëŠ”</span>
<span class="c1">// rewrite ê°’ì´ 0ì´ ì•„ë‹ˆë©´ ì›ë˜ ê°’ì„ ìƒˆë¡œìš´ ê°’ìœ¼ë¡œ ëŒ€ì²´í•˜ê³  rewrite ê°’ì´ 0ì´ë©´ ê·¸ëŒ€ë¡œ ë‘”ë‹¤.</span>
<span class="kt">int</span> <span class="nf">unsetenv</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">);</span>
<span class="c1">// í™˜ê²½ ë³€ìˆ˜ nameì˜ ê°’ì„ ì§€ìš´ë‹¤.</span>
</code></pre></div></div>

<p><br /></p>

<h1 id="83-í”„ë¡œê·¸ë¨-ì¢…ë£Œ">8.3 í”„ë¡œê·¸ë¨ ì¢…ë£Œ</h1>

<h2 id="í”„ë¡œê·¸ë¨-ì¢…ë£Œ-process-termination">í”„ë¡œê·¸ë¨ ì¢…ë£Œ (Process termination)</h2>

<ul>
  <li><strong>ì •ìƒ ì¢…ë£Œ</strong>(normal termination)
    <ul>
      <li>main() ì‹¤í–‰ì„ ë§ˆì¹˜ê³  ë¦¬í„´í•˜ë©´ <strong>C ì‹œì‘ ë£¨í‹´</strong>ì€ ì´ ë¦¬í„´ê°’ì„ ê°€ì§€ ê³  exit()ì„ í˜¸ì¶œ</li>
      <li>í”„ë¡œê·¸ë¨ ë‚´ì—ì„œ ì§ì ‘ exit()ì„ í˜¸ì¶œ</li>
      <li>í”„ë¡œê·¸ë¨ ë‚´ì—ì„œ ì§ì ‘ _exit()ì„ í˜¸ì¶œ</li>
    </ul>
  </li>
  <li>ë¹„ì •ìƒ ì¢…ë£Œ(abnormal termination)
    <ul>
      <li><strong>abort() ì‹œìŠ¤í…œ ì½œ í˜¸ì¶œ</strong>
        <ul>
          <li>í”„ë¡œì„¸ìŠ¤ì— SIGABRT ì‹œê·¸ë„ì„ ë³´ë‚´ì–´ í”„ë¡œì„¸ìŠ¤ë¥¼ ë¹„ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œì‹œí‚´</li>
        </ul>
      </li>
      <li>ì‹œê·¸ë„ ìˆ˜ì‹ ì— ì˜í•œ ì¢…ë£Œ</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="í”„ë¡œê·¸ë¨-ì¢…ë£Œ">í”„ë¡œê·¸ë¨ ì¢…ë£Œ</h2>

<ul>
  <li><strong>exit()</strong>
    <ul>
      <li>Cleanup processing ì„ ìˆ˜í–‰í•˜ê³  ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œí•œë‹¤
        <ul>
          <li>(open ë˜ì–´ì¡Œë˜ )ëª¨ë“  ì—´ë ¤ì§„ ìŠ¤íŠ¸ë¦¼ì„ ë‹«ê³ (fclose),</li>
          <li>ì¶œë ¥ ë²„í¼ì˜ ë‚´ìš©ì„ ë””ìŠ¤í¬ì— ì“°ëŠ”(fflush), ë©”ëª¨ë¦¬ íšŒìˆ˜(ë°˜ë‚©) ë“±ì˜ ë’·ì •ë¦¬ í›„ í”„ë¡œì„¸ìŠ¤ë¥¼ ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œ</li>
        </ul>
      </li>
      <li>ì¢…ë£Œ ì½”ë“œ(exit code)ë¥¼ ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ì—ê²Œ ì „ë‹¬í•œë‹¤.</li>
    </ul>
  </li>
</ul>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="kt">void</span> <span class="nf">exit</span><span class="p">(</span><span class="kt">int</span> <span class="n">status</span><span class="p">);</span>
<span class="c1">//ë’·ì •ë¦¬ë¥¼ í•œ í›„ í”„ë¡œì„¸ìŠ¤ë¥¼ ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œì‹œí‚¨ë‹¤. return to the kernel</span>
</code></pre></div></div>

<ul>
  <li><strong>_exit()</strong></li>
</ul>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="kt">void</span> <span class="nf">_exit</span><span class="p">(</span><span class="kt">int</span> <span class="n">status</span><span class="p">);</span>
<span class="c1">//ë’·ì •ë¦¬ë¥¼ í•˜ì§€ ì•Šê³  í”„ë¡œì„¸ìŠ¤ë¥¼ ì¦‰ì‹œ (ì •ìƒ)ì¢…ë£Œì‹œí‚¨ë‹¤.</span>
<span class="c1">//return to the kernel immediately</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="c-í”„ë¡œê·¸ë¨-ì‹œì‘-ë°-ì¢…ë£Œì¤‘ìš”">C í”„ë¡œê·¸ë¨ ì‹œì‘ ë° ì¢…ë£Œ(ì¤‘ìš”)</h2>

<p><img src="https://user-images.githubusercontent.com/79521972/167348475-2c718100-13af-4221-b31c-bce4cf0284d8.png" alt="image" /></p>

<ul>
  <li>ë‚´ê°€ ì§  main í•¨ìˆ˜, ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜ì™€ ë”ë¶ˆì–´ C start-up routineì´ ë”í•´ì„œ ì‹¤í–‰ íŒŒì¼ì´ ë§Œë“¤ì–´ ì§„ë‹¤.</li>
  <li>main í•¨ìˆ˜ê°€ ë¦¬í„´í•  ë•Œë„ C start-up routineì„ ê±°ì³ì„œ exit()ì´ ì‹¤í–‰ë˜ì–´ ì¢…ë£Œ ë  ìˆ˜ ìˆê³ ,</li>
  <li>user functionì´ë‚˜ main function ë‚´ì—ì„œë„ exit() ì„ í˜¸ì¶œí•˜ì—¬ ì¢…ë£Œë  ìˆ˜ë„ ìˆë‹¤.</li>
  <li>â€˜does not returnâ€™ means
    <ul>
      <li>exit(main())ì€ ë¦¬í„´í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ê·¸ëƒ¥ kernelë¡œ ë„˜ì–´ê°€ëŠ” ê²ƒì´ë‹¤.</li>
      <li>ì™œëƒí•˜ë©´ execve() ì‹œìŠ¤í…œ í˜¸ì¶œì„ í†µí•´ì„œ process imageë¥¼ ì™„ì „íˆ ë°”ê¿”ë²„ë ¸ê¸° ë•Œë¬¸ì— return í•  ê³³(ì›ë˜ìê¸°ë¥¼ ë¶ˆë €ë˜ í”„ë¡œì„¸ìŠ¤) ì´ ì—†ì–´ì¡Œê¸° ë•Œë¬¸ì´ë‹¤.</li>
    </ul>
  </li>
  <li>exit handler: ì‚¬ìš©ìê°€ ì •ì˜í•œ exit handler</li>
  <li>standard I/O cleanupê¹Œì§€ ì™„ë£Œí•œ í›„ ìµœì¢…ì ìœ¼ë¡œ _exit() í˜¸ì¶œ</li>
</ul>

<p><br /></p>

<h2 id="ì‰˜ì˜-êµ¬ì¡°-revisit">ì‰˜ì˜ êµ¬ì¡° (revisit)</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">While</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">display</span> <span class="n">prompt</span>
    <span class="n">read</span> <span class="n">command</span> <span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span> <span class="c1">// Get command (ex. ls)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">fork</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">then</span> <span class="p">{</span> <span class="c1">// Shell process (ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤)</span>
        <span class="n">wait</span><span class="p">(</span><span class="o">&amp;</span><span class="n">status</span><span class="p">);</span> <span class="c1">// Execute command (ìì‹ í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ wait)</span>
        <span class="n">exit</span><span class="p">()</span> <span class="c1">// fork a child, wait for a child to finish</span>
    <span class="p">}</span>
    <span class="k">else</span>
    	<span class="n">execve</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">parmas</span><span class="p">)</span> <span class="c1">// ìì‹ í”„ë¡œì„¸ìŠ¤</span>
<span class="p">}</span> 								<span class="c1">// ì…ë ¥ëœ ëª…ë ¹ì–´ í”„ë¡œê·¸ë¨ ì‹¤í–‰</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls</span>
<span class="nb">.</span> .. /etc
/home /usr /dev
<span class="err">$</span>
</code></pre></div></div>

<p><br /></p>

<h2 id="í”„ë¡œê·¸ë¨-ì‹¤í–‰-ì‹œì‘-revisit">í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì‹œì‘ (revisit)</h2>

<p><img src="https://user-images.githubusercontent.com/79521972/167991038-8b396c8a-c0f7-4120-902e-298a5e466ea2.png" alt="image" /></p>

<p><br /></p>

<h2 id="atexit">atexit()</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="kt">void</span> <span class="nf">atexit</span><span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">func</span><span class="p">)(</span><span class="kt">void</span><span class="p">));</span>
	<span class="c1">//returns: 0 if OK, nonzero on error</span>
</code></pre></div></div>

<ul>
  <li>exit ì²˜ë¦¬ê¸°ë¥¼ ë“±ë¡í•œë‹¤.
    <ul>
      <li>í”„ë¡œì„¸ìŠ¤ë‹¹ 32ê°œê¹Œì§€</li>
    </ul>
  </li>
  <li>func
    <ul>
      <li>exit ì²˜ë¦¬ê¸°</li>
      <li>í•¨ìˆ˜ í¬ì¸í„°(ì´ë¦„)</li>
    </ul>
  </li>
  <li>exit()ëŠ” exit handler ë“¤ì„ ë“±ë¡ëœ ì—­ìˆœìœ¼ë¡œ í˜¸ì¶œí•œë‹¤.
    <ul>
      <li>ë§¨ ë§ˆì§€ë§‰ì— ë“±ë¡ëœ handler ìˆœìœ¼ë¡œ ì‹¤í–‰</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="exit-ì²˜ë¦¬ê¸°-ì˜ˆ">exit ì²˜ë¦¬ê¸° ì˜ˆ</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">my_exit1</span><span class="p">(</span><span class="kt">void</span><span class="p">),</span>
<span class="n">my_exit2</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">atexit</span><span class="p">(</span><span class="n">exit_handler1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">perror</span><span class="p">(</span><span class="s">"exit_handler1 ë“±ë¡í•  ìˆ˜ ì—†ìŒ"</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">atexit</span><span class="p">(</span><span class="n">exit_handler2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">perror</span><span class="p">(</span><span class="s">"exit_handler2 ë“±ë¡í•  ìˆ˜ ì—†ìŒ"</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"main ë </span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">exit_handler1</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"ì²« ë²ˆì§¸ exit ì²˜ë¦¬ê¸°</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">exit_handler2</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"ë‘ ë²ˆì§¸ exit ì²˜ë¦¬ê¸°</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>atexit
main ë
ë‘ ë²ˆì§¸ <span class="nb">exit </span>ì²˜ë¦¬ê¸°
ì²« ë²ˆì§¸ <span class="nb">exit </span>ì²˜ë¦¬ê¸°
</code></pre></div></div>

<p><br /></p>

<h2 id="termination-status--exit-status">Termination status  (Exit status)</h2>

<ul>
  <li>Terminating process notify its parent how it terminated.
    <ul>
      <li>í”„ë¡œì„¸ìŠ¤ê°€ ì¢…ë£Œë  ë•ŒëŠ” parent processì—ê²Œ ì–´ë– í•œ <strong>ì´ìœ ë¡œ</strong> ì¢…ë£Œë˜ì—ˆëŠ”ì§€ë¥¼ í†µë³´í•˜ê²Œ ëœë‹¤.</li>
    </ul>
  </li>
  <li><strong>normal termination</strong>
    <ul>
      <li>pass an <strong>exit status</strong> as argument to exit() or _exit().</li>
      <li>return value from main()
        <ul>
          <li>exit( main( argc, argv) );</li>
          <li>void exit(int status);       void _exit(int status);</li>
        </ul>
      </li>
      <li>exit status is converted into a <strong>termination status</strong>.</li>
    </ul>
  </li>
  <li><strong>abnormal termination</strong>
    <ul>
      <li>Kernel generates a <strong>termination status</strong>(ì¢…ë£Œ ì´ìœ ) to indicate the reason for the abnormal termination.</li>
    </ul>
  </li>
  <li>The parent of the terminated process can obtain the termination status from <strong>wait()</strong> or <strong>waitpid()</strong>.
    <ul>
      <li>wait(): ìì‹ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ</li>
      <li>waitpid(): íŠ¹ì • í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ</li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="termination-status-exit-status">Termination status (Exit status)</h2>

<ul>
  <li>Exit status:
    <ul>
      <li>argument of exit( ), _exit( )</li>
      <li>the return value from main( ): exit(main( ))</li>
      <li>UNIX shell ì— ì˜í•´ì„œ ì‚¬ìš©ë¨</li>
    </ul>
  </li>
  <li>Termination status:
    <ul>
      <li>Normal termination:
        <ul>
          <li>Exit status : Termination status</li>
        </ul>
      </li>
      <li>Abnormal termination:
        <ul>
          <li><strong>kernel</strong> indicates reason : Termination status</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="exit---termination-status">exit() - Termination status</h2>

<ul>
  <li>Child terminates
    <ul>
      <li>Kernel sends SIGCHLD signal to parent</li>
    </ul>
  </li>
  <li>Parent wait() or waitpid()
    <ul>
      <li>parent can obtain the termination status of the child</li>
      <li>wait() fetch the termination status of child <strong>when receiving SIGCHLD signal</strong></li>
    </ul>
  </li>
</ul>

<p><br /></p>

<h2 id="exit---termination-status-1">exit() - Termination status</h2>

<ul>
  <li><strong>zombie state</strong>
    <ul>
      <li>Kernel has to keep some information (ìì‹ processì— ê´€í•œ ì •ë³´)
        <ul>
          <li>PID, termination status, and CPU usage time</li>
          <li>This information is available when parent calls wait().</li>
        </ul>
      </li>
      <li>the process that has terminated, but whose parent has not yet waited for it, is called a <strong>zombie</strong>.
        <ul>
          <li>ìì‹ processê°€ ì¢…ë£Œê°€ ë˜ì—ˆëŠ”ë° ì´ í”„ë¡œì„¸ìŠ¤ì˜ parent processê°€ <strong>wait system callì„ í˜¸ì¶œí•˜ì§€ ì•Šì€ ê²½ìš°</strong>ì— ì¢…ë£Œëœ processë¥¼ <strong>zombie process</strong>ë¼ê³  í•œë‹¤.</li>
          <li>If no parent waiting (did not invoke <strong>wait()</strong>) process is a <strong>zombie</strong></li>
        </ul>
      </li>
      <li>If parent terminated without invoking <strong>wait</strong> , process is an <strong>orphan</strong></li>
    </ul>
  </li>
  <li>If the parent terminates before the child?
    <ul>
      <li>init process becomes the parent of the child (orphaned) process.</li>
      <li>init process: ëª¨ë“  processì˜ ì¡°ìƒ process</li>
    </ul>
  </li>
  <li>If an orphaned process is terminated?
    <ul>
      <li>init calls wait() to fetch the termination status.</li>
    </ul>
  </li>
</ul>

<p><br /></p>

:ET