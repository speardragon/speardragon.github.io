I"bâ<p><br /></p>

<h1 id="13-shortest-path-algorithms">13. Shortest Path Algorithms</h1>

<p>13-2</p>

<h2 id="single-source-shortest-paths">Single-Source Shortest Paths</h2>

<p>In a shortest-paths problem, we are in given a <strong>weighted</strong>, directed graph G = (V, E), 
with <strong>weight function</strong> <img src="https://user-images.githubusercontent.com/79521972/170176160-90ec4724-0977-4ee6-8986-272a5c5ce0ee.png" alt="image" /> mapping edges to real-valued weights. (ê° edgeë§ˆë‹¤ ì£¼ì–´ì§€ëŠ” pathê°’)</p>

<p>The <strong>weight w(p) of path</strong> <img src="https://user-images.githubusercontent.com/79521972/170176223-bae160b8-1367-44f5-8b69-42d7995b530d.png" alt="image" /> is the <mark>sum of the weights of its constituent edges</mark>:</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170176273-fbc88005-e5b9-45b4-8a29-ef4181d24ebd.png" alt="image" /></p>

<p>We define the shortest-path weight <img src="https://user-images.githubusercontent.com/79521972/170176307-bb59afbf-7f7e-4857-a314-0cee34df23f7.png" alt="image" /> from u to v by</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170176346-467c4514-78a0-445b-86e2-a2d558f175de.png" alt="image" /></p>

<p>A <strong>shortest path</strong> from vertex u to vertex v is then defined as any path p with weight <img src="https://user-images.githubusercontent.com/79521972/170176387-09e46dc4-3748-4906-bc9b-e882d1761a5d.png" alt="image" /></p>

<hr />

<p>13-3</p>

<h2 id="optimal-substructure-of-a-shortest-path">Optimal substructure of a shortest path</h2>

<p>Shortest-paths algorithms typically rely on the property that a shortest path <u>between two vertices contains</u> <u>other shortest paths within it</u>.</p>

<p>Recall that optimal substructure is one of the key indicators that dynamic programming (Chapter 15.) and the greedy method (Chapter 16) might apply.</p>

<ul>
  <li>shortest pathëŠ” ê·¸ ì•ˆì— ì¡´ì¬í•˜ëŠ” sub pathì—ì„œë„ shortest pathì¸ êµ¬ì¡°ì´ë‹¤.</li>
</ul>

<p><img src="https://user-images.githubusercontent.com/79521972/170176866-0701837a-593a-4747-9fb7-bc26d7c5a248.png" alt="image" /></p>

<p>ì£¼ì–´ì§„ ê°€ì¤‘, ë°©í–¥ì„± ê·¸ë˜í”„ì—ì„œ weight function wì— ëŒ€í•´ì„œ pê°€ voì—ì„œ vkê¹Œì§€ì˜ ìµœë‹¨ ê²½ë¡œê°€ ë˜ë„ë¡ í•˜ë ¤ê³  í•˜ë©´, 0&lt;i&lt;j&lt;kë¥¼ ë§Œì¡±í•˜ëŠ” ì–´ë– í•œ iì™€ jì— ëŒ€í•´ì„œ viì—ì„œ vjë¡œ ê°€ëŠ” pì˜ subpathê°€ ë˜ë„ë¡ í•˜ì.</p>

<p>ê·¸ë•Œ pijëŠ” viì—ì„œ vjê¹Œì§€ ê°€ëŠ” ìµœë‹¨ ê²½ë¡œì´ë‹¤.</p>

<hr />

<p>13-4</p>

<h2 id="negative-weight-edges">Negative-weight edges</h2>

<p><img src="https://user-images.githubusercontent.com/79521972/170176922-e435998b-bdd8-466b-9e23-f828d82b54cd.png" alt="image" /></p>

<ul>
  <li>
    <p>c&lt;-&gt;d ëŠ” cycleì¸ë° í•œ ë²ˆ ê°”ë‹¤ê°€ ë‹¤ì‹œ ì˜¤ë©´ cost 3ì´ ë“ ë‹¤.</p>
  </li>
  <li>
    <p>e&lt;-&gt;f ì—­ì‹œë„ cycleì¸ë° í•œ ë²ˆ ê°”ë‹¤ê°€ ë‹¤ì‹œ ì˜¤ë©´ cost -3ì´ ëœë‹¤. -&gt; negative-weight cycle</p>
  </li>
  <li>
    <p>ê·¸ëŸ°ë° ì´ negative-weight cycleì´ ìˆìœ¼ë©´ shortest pathê°€ ì¡´ì¬í•  ìˆ˜ ì—†ëŠ”ë° ê·¸ ì´ìœ ëŠ” shortest pathëŠ” ìµœì†Œí•œì˜ costê°€ ë“œëŠ” ê±°ë¦¬ë¥¼ ì°¾ëŠ” ê²ƒì¸ë° negative cycleì„ ë°œê²¬í•˜ë©´ costë¥¼ ê³„ì†í•´ì„œ ì¤„ì´ë ¤ê³  í•˜ê¸° ë•Œë¬¸ì— ê·¸ loopë¥¼ ë¹ ì ¸ë‚˜ê°€ì§€ ì•Šê²Œ ë  ê²ƒì´ê³  shortest pathëŠ” ê²°êµ­ negative infinityê°€ ë  ê²ƒì´ë‹¤.</p>
  </li>
  <li>
    <p>sì—ì„œ ì‹œì‘í•´ì„œ h, i, j ê¹Œì§€ ê°ˆ ìˆ˜ìˆëŠ” ì—°ê²°ëœ edgeê°€ ì—†ê¸° ë•Œë¬¸ì— í•´ë‹¹ ë…¸ë“œë“¤ì€ ë¬´í•œëŒ€ì˜ ê°’ì„ ê°€ì§€ê²Œ ëœë‹¤.</p>
    <ul>
      <li>ì´ ë…¸ë“œë“¤ì—ê²Œ ê°€ë ¤ë©´ ë¬´í•œëŒ€ì˜ pathë¥¼ ê°€ë„ ê°ˆ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ë¬´í•œëŒ€ë¡œ í•œê²ƒ</li>
    </ul>
  </li>
</ul>

<hr />

<p>13-5</p>

<h2 id="representing-shortest-paths">Representing shortest paths</h2>

<p>Given a graph G = (V, E), we maintain for each vertex v âˆˆ V a <strong>predecessor(ì„ ì„, ì´ì „ì˜)</strong> v.<em>Ï€</em> that is either another vertex of NIL.</p>

<ul>
  <li>ê·¸ë˜ì„œ v.<em>Ï€</em>ëŠ” v ë…¸ë“œê¹Œì§€ ì™”ì„ ë•Œ ë°”ë¡œ ì• ë…¸ë“œë¥¼ ë§í•˜ê³ 
    <ul>
      <li>t.<em>Ï€</em>  = s</li>
    </ul>
  </li>
  <li>ê° vertexì—ì„œëŠ” ê³„ì†í•´ì„œ predecessorë¥¼ ê´€ë¦¬í•´ ì¤€ë‹¤.
    <ul>
      <li>predecessorëŠ” ê²½ë¡œë§ˆë‹¤ ë°”ë€” ìˆ˜ ìˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p><img src="https://user-images.githubusercontent.com/79521972/170177273-0b478141-5c70-4bfe-a4cf-ed3080379dc4.png" alt="image" /></p>

<p>(a)ì— ëŒ€í•œ shortest pathë¥¼ êµ¬í•´ ë³´ë©´ (b)ì²˜ëŸ¼ ë  ìˆ˜ë„ (c)ì²˜ëŸ¼ ë  ìˆ˜ë„ ìˆë‹¤.</p>

<hr />

<p>13-6</p>

<h2 id="initialize-single-source">Initialize-Single-Source</h2>

<p>For each vertex v âˆˆ V, we maintain an attribute v.d, which is an upper bound on the weight of a shortest path from source s to v. We call <strong>v.d</strong> a <strong>shortest-path estimate</strong>. We initialize the shortest-path estimates and predecessors by the following <img src="https://user-images.githubusercontent.com/79521972/170177462-601c7941-2e40-4ff9-84bb-912a621c0a0b.png" alt="image" />-time procedure:</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170177498-b950d302-4aaa-4b16-b0bf-caaa18fb0505.png" alt="image" /></p>

<ul>
  <li>
    <p>GëŠ” ë‚´ê°€ê°€ì§€ê³  ìˆëŠ” graph</p>
  </li>
  <li>
    <p>VëŠ” vertexì˜ ì§‘í•©</p>
  </li>
  <li>
    <p>v.d ëŠ” shortest-path estimateì´ë‹¤.</p>
    <ul>
      <li>sourceì—ì„œ ëª¨ë“  vertexê¹Œì§€ì˜ ì¶”ì •ë˜ëŠ” shortest distance ê°’ì´ë¯€ë¡œ ì²˜ìŒì—ëŠ” ëª¨ë‘ <strong>ë¬´í•œëŒ€ë¡œ ì´ˆê¸°í™”</strong>í•œë‹¤.</li>
      <li>
        <p>ê·¸ ë°”ë¡œ ì•ì— ìˆëŠ” ë…¸ë“œì—­ì‹œ ì²˜ìŒì´ê¸° ë•Œë¬¸ì— ê°’ì„ ì•„ì§ ë°›ì€ ê²ƒì´ ì—†ì–´ Noneë¡œ ì´ˆê¸°í™” í•œë‹¤.</p>
      </li>
      <li>s.d ì¦‰, sourceì—ì„œ sourceê¹Œì§€ì˜ distanceëŠ” ë‹¹ì—°íˆ 0ì´ë‹¤.(ê°™ì€ ë…¸ë“œì´ë‹ˆê¹Œ)</li>
    </ul>
  </li>
</ul>

<hr />

<p>13-7</p>

<h2 id="relaxation">Relaxation</h2>

<p>shortest pathë¥¼ ì°¾ê¸° ìœ„í•´ì„œ ê³µí†µì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•</p>

<p>The process of <strong>relaxing an edge (u, v)</strong> consists of testing whether we can improve the shortest path to v found so far by going through u and, if so, updating v.d and v.<em>Ï€</em> . A relaxation step may decrease the value of the shortest-path estimate v.d and update vâ€™s predecessor attribute v.<em>Ï€</em></p>

<p><img src="https://user-images.githubusercontent.com/79521972/170177716-d41110ac-c539-4697-9674-630836c66677.png" alt="image" /></p>

<ul>
  <li>í˜„ì¬ê¹Œì§€ ì•Œë ¤ì§„ uê¹Œì§€ì˜ ê±°ë¦¬ - u.d</li>
  <li>í˜„ì¬ê¹Œì§€ ì•Œë ¤ì§„ vê¹Œì§€ì˜ ê±°ë¦¬ -  v.d</li>
  <li>relaxí•œë‹¤ëŠ” ê²ƒì€ u ë¥¼ update í•œë‹¤ëŠ” ê²ƒì´ë‹¤.
    <ul>
      <li>í˜„ì¬ vì˜ ê²½ë¡œ ë³´ë‹¤ uë¥¼ ë“¤ë¦¬ë©´ ë” ì§§ì€ ê²½ë¡œê°€ ìˆëŠ”ì§€ë¥¼ í™•ì¸í•˜ê³  ë” ì§§ë‹¤ë©´ ê·¸ ê²½ë¡œë¡œ updateí•œë‹¤ëŠ” ê²ƒ</li>
    </ul>
  </li>
</ul>

<hr />

<p>13-8</p>

<h2 id="relxation">Relxation</h2>

<p><img src="https://user-images.githubusercontent.com/79521972/170177765-be7ce602-30f2-4f2b-a003-3b8e9eb9b6ba.png" alt="image" /></p>

<p>Each algorithm in the chapter calls Initialize-single-source and then repeatedly relaxes edges.</p>

<p>Moreover, <mark>relaxation is the only means by which shortest-path estimates and predecessors change.</mark></p>

<p>The algorithms in the chapter differ in how many times they relax each edge and the order in which they relax edges.</p>

<p><strong>Dijkstraâ€™s algorithm</strong> and <strong>the shortest-paths algorithm</strong> for directed acyclic graphs relax <strong>each edge exactly once</strong>.</p>

<ul>
  <li>ë…¸ë“œ ë‹¹ ì •í™•íˆ í•œ ë²ˆ</li>
</ul>

<table>
  <tbody>
    <tr>
      <td>The Bellman-Ford algorithm relaxes **each edge</td>
      <td>V</td>
      <td>ã…¡ 1 times.**</td>
    </tr>
  </tbody>
</table>

<hr />

<p>13-9</p>

<h2 id="241-the-bellman-ford-algorithm">24.1 The Bellman-Ford algorithm</h2>

<p><img src="https://user-images.githubusercontent.com/79521972/170178173-481702e0-472d-4e02-b3a5-4d6f32b72acc.png" alt="image" /></p>

<ul>
  <li><strong>Bellman-Fordì˜ ì¥ì </strong>ì€ edgeì˜ weightê°€ <strong>negativeì—¬ë„</strong> ë™ì‘í•œë‹¤ëŠ” ê²ƒì´ë‹¤.
    <ul>
      <li>ë‹¤ìµìŠ¤íŠ¸ë¼ëŠ” ë™ì‘ ì•ˆ í•¨.</li>
    </ul>
  </li>
  <li>ê°€ì¥ ë¨¼ì € <strong>negative cycle</strong>ì´ ìˆëŠ”ì§€ë¥¼ íŒë‹¨í•´ì•¼ í•¨.
    <ul>
      <li>ë§Œì•½ ìˆë‹¤ë©´ algorithmì„ ëŒë ¤ë„ solutionì´ êµ¬í•´ì§€ì§€ ì•ŠëŠ”ë‹¤.</li>
      <li>ì—†ìœ¼ë©´ shortest pathë¥¼ êµ¬í•œë‹¤.</li>
    </ul>
  </li>
</ul>

<hr />

<p>13-10</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170193534-6946bb44-ec0f-44eb-87de-622eabebd8e2.png" alt="image" /></p>

<ul>
  <li>Initialize</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>forë¬¸ - {</td>
          <td>G.V</td>
          <td>- 1 }ë²ˆ</td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <table>
          <tbody>
            <tr>
              <td>G.V</td>
              <td>-&gt; vertexì˜ ê°¯ìˆ˜</td>
            </tr>
          </tbody>
        </table>
      </li>
      <li>Edgeì˜ ì§‘í•©ì— ì†í•˜ëŠ” ê° edgeë§ˆë‹¤ í•œ ë²ˆì”© relaxë¥¼ í•´ ì¤€ë‹¤.
        <ul>
          <li>ëª¨ë“  edgeë¥¼ update</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ì´ ê²°ê³¼ negative (weight) cycleì´ ìˆë‹¤ë©´ ì´ìƒí•œ ê²°ê³¼ê°€ ë“¤ì–´ê°€ ìˆì„ ê²ƒì´ê³  ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ shortest pathê°€ êµ¬í•´ì¡Œì„ ê²ƒì´ë‹¤.</li>
</ul>

<p><img src="https://user-images.githubusercontent.com/79521972/170193554-ed2a7cd4-2c2a-4390-809e-f564bbaf4c79.png" alt="image" /></p>

<hr />

<p>13-11</p>

<p>ì¤‘ìš”!!</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170178238-1bc3166a-f4cd-48dd-9266-5b8a0556d5c7.png" alt="image" /></p>

<p>ì´ˆê¸°ì—ëŠ” ëª¨ë“  ë…¸ë“œì— ë¬´í•œëŒ€ê°€ ë“¤ì–´ìˆê¸° ë•Œë¬¸ì— sì—ì„œ ì‹œì‘í•˜ëŠ” ê²ƒë§Œ update ë  ìˆ˜ ìˆë‹¤.</p>

<p>ê° edgeë¥¼ ë¬´ìŠ¨ ìˆœì„œëŒ€ë¡œ relax í•˜ëŠ” ì§€ëŠ” ì¤‘ìš”í•˜ì§€ ì•Šë‹¤.</p>

<p>ê²°ê³¼ì ìœ¼ë¡œ sourceì—ì„œ dest ë…¸ë“œê¹Œì§€ ê°€ë©´ì„œ ê±°ì¹˜ëŠ” ë…¸ë“œë“¤ì— ëŒ€í•œ ê°ê°ì˜ shortest pathì— ëŒ€í•œ ì •ë³´ (v.d, v.ã… )ê°€ ê°ì ë‹¤ ê°–ê³  ìˆê²Œ ë  ê²ƒì´ë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># ì—…ë°ì´íŠ¸ê°€ ì–´ë–¤ ì‹ìœ¼ë¡œ ë˜ëŠ”ì§€ í•œ ë²ˆ ê·¸ë ¤ë³´ê¸°


</code></pre></div></div>

<hr />

<p>13-12</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170178266-d8781ec5-a013-470d-98bc-abccedc57581.png" alt="image" /></p>

<ul>
  <li>
    <table>
      <tbody>
        <tr>
          <td>ì•ì„œ</td>
          <td>V</td>
          <td>-1 ë§Œí¼ for loopë¥¼ ëŒë ¤ì„œ ì–»ì–´ë‚¸ ê²°ê³¼ê°€ shortest pathì¸ì§€ ì•„ë‹ˆë©´ strange valueì¸ì§€ë¥¼ ì•Œì•„ë‚´ëŠ” ì‘ì—…ì´ í•„ìš”í•œë° ì´ëŠ” ìœ„ì˜ ì½”ë“œì™€ ê°™ì´ ì‘ì„±í•˜ë©´ ëœë‹¤.</td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>ëª¨ë“  edgeì— ëŒ€í•´ì„œ ë°˜ë³µí•˜ë©´ì„œ</li>
      <li><strong>v.d &gt; u.d + w(u, v)</strong> ì´ë©´ ì¦‰, uë¥¼ í†µí•˜ë©´ ë” ë¹¨ë¦¬ ê°ˆ ìˆ˜ ìˆëŠ” ê²½ìš°ê°€ ì–´ë–¤ edgeì—ì„œ ì¡´ì¬í•œë‹¤ê³  íŒë‹¨ ë˜ì—ˆë‹¤ëŠ” ê²ƒì€ bellman-Ford ì•Œê³ ë¦¬ì¦˜ì´ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šì•˜ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ê¸° ë•Œë¬¸ì— ì´ ê²½ìš°ëŠ” <strong>negative cycle</strong>ì´ ìˆë‹¤ê³  ìœ ì¶”í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.</li>
      <li>ê·¸ê²Œ ì•„ë‹ˆë¼ë©´ ì œëŒ€ë¡œ êµ¬í•´ì§„ ê²ƒì´ê¸° ë•Œë¬¸ì— Trueë¥¼ ë¦¬í„´</li>
    </ul>
  </li>
  <li>O(E(V-1)) =&gt; O(EV)</li>
</ul>

<hr />

<p>13-13</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">bellman_ford</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>  <span class="c1"># 1
</span>    <span class="c1"># intialize
</span>    <span class="n">distance</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># v.d
</span>    <span class="n">predecessor</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># v.ã… 
</span>    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">.</span><span class="n">keys</span><span class="p">():</span>  <span class="c1"># 5
</span>        <span class="n">distance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">'inf'</span><span class="p">)</span>
        <span class="n">predecessor</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">distance</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># relax all edges for V-1 times
</span>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># 11
</span>        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">:</span>  <span class="c1"># ì´ì¤‘ dictionary ì¼ ê²ƒì´ê¸° ë•Œë¬¸ì— uë„ dictionaryì„ -&gt; keyë¥¼ í•˜ë‚˜ì”©
</span>            <span class="c1"># w is the weight of edge (u, v)
</span>            <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">items</span><span class="p">():</span>  <span class="c1"># 14
</span>                <span class="k">if</span> <span class="n">distance</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">distance</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">:</span>
                    <span class="n">distance</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span>
                    <span class="n">predecessor</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span>

    <span class="c1"># check for a negative-weight cycle
</span>    <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">:</span>  <span class="c1"># 20
</span>        <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">distance</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">distance</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">predecessor</span>

    <span class="k">return</span> <span class="bp">True</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">predecessor</span>


<span class="n">Fig24_4</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># 28; ì•ì— ìˆëŠ” ê·¸ë˜í”„ ê·¸ë¦¼ì— ëŒ€í•œ adjacency list
</span>    <span class="s">'s'</span><span class="p">:</span> <span class="p">{</span><span class="s">'t'</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s">'y'</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span>
    <span class="s">'t'</span><span class="p">:</span> <span class="p">{</span><span class="s">'x'</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">'y'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s">'z'</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="p">},</span>
    <span class="s">'x'</span><span class="p">:</span> <span class="p">{</span><span class="s">'t'</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="p">},</span>
    <span class="s">'y'</span><span class="p">:</span> <span class="p">{</span><span class="s">'x'</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="s">'z'</span><span class="p">:</span> <span class="mi">9</span><span class="p">},</span>
    <span class="s">'z'</span><span class="p">:</span> <span class="p">{</span><span class="s">'s'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">'x'</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
<span class="p">}</span>
<span class="n">check</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">pre</span> <span class="o">=</span> <span class="n">bellman_ford</span><span class="p">(</span><span class="n">Fig24_4</span><span class="p">,</span> <span class="s">'s'</span><span class="p">)</span>  <span class="c1"># 35; graphì™€ source ë…¸ë“œë¥¼ ë„˜ê²¨ì¤Œ
</span><span class="k">if</span> <span class="n">check</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">pre</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>

</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/79521972/170179063-21ac162b-faed-41bf-b161-680c58855671.png" alt="image" /></p>

<ul>
  <li>
    <p>graphì˜ keyëŠ” u -&gt; predecessor</p>
  </li>
  <li>
    <p>vëŠ” í˜„ì¬ ë…¸ë“œ</p>
  </li>
  <li>
    <p>ì²˜ìŒì— distance[v]ê°€ ë¬´í•œëŒ€ì¼ ê²ƒì´ê¸° ë•Œë¬¸ì— distance[u] + w(eight) ë³´ë‹¤ëŠ” ë¬´ì¡°ê±´ í´ ê²ƒì´ê³  í•´ë‹¹ ë…¸ë“œì˜ distance[v]ë¥¼ distance[u] + wë¡œ ì´ˆê¸°í™”í•˜ëŠ” ê²ƒì´ë‹¤.</p>
  </li>
  <li>ê·¸ë¦¬ê³  í•´ë‹¹ ë…¸ë“œì˜ predecessorë¥¼ uë¡œ updateí•œë‹¤.</li>
  <li>predecessor ëŠ” shortest pathê°€ ì •í•´ì§€ë©´ í•´ë‹¹ ë…¸ë“œì— ì˜¤ê¸°ê¹Œì§€ ë°”ë¡œ ì „ ë…¸ë“œë¥¼ ì˜ë¯¸í•œë‹¤.</li>
</ul>

<hr />

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">bellamn_ford</span><span class="p">(</span><span class="n">grpah</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span> <span class="c1"># 1
</span>    <span class="c1"># intialize
</span>    <span class="n">distance</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># v.d
</span>    <span class="n">predecessor</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># v.ã… 
</span>    <span class="k">for</span> <span class="n">node</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">.</span><span class="n">keys</span><span class="p">():</span> <span class="c1"># 5
</span>        <span class="n">distance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s">'inf'</span><span class="p">)</span>
        <span class="n">predecessor</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">distance</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></div>

<p>forë¬¸ì„ í•œ ë²ˆì”© ëŒ ë•Œë§ˆë‹¤ distanceê°€ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ í•œ ë²ˆ ì°ì–´ë³´ê¸°</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'s': inf}
{'s': None}

{'s': inf, 't': inf}
{'s': None, 't': None}

{'s': inf, 't': inf, 'x': inf}
{'s': None, 't': None, 'x': None}

{'s': inf, 't': inf, 'x': inf, 'y': inf}
{'s': None, 't': None, 'x': None, 'y': None}

{'s': inf, 't': inf, 'x': inf, 'y': inf, 'z': inf}
{'s': None, 't': None, 'x': None, 'y': None, 'z': None}
</code></pre></div></div>

<hr />

<p>13-15</p>

<h2 id="detecting-negative-weight-cycles-in-a-disconnected-graph">Detecting Negative-Weight Cycles in a Disconnected Graph</h2>

<p><img src="https://user-images.githubusercontent.com/79521972/170179127-de736de3-dcbe-44fb-af71-0009208fda7a.png" alt="image" /></p>

<ul>
  <li>ì²˜ìŒì— ì´ˆê¸°í™”ë¥¼ í•œë‹¤.
    <ul>
      <li>sourceì—ì„œ cê¹Œì§€ì˜ distance -&gt; ë¬´í•œëŒ€</li>
      <li>sì—ì„œ e, fê¹Œì§€ì˜ distance -&gt; ë¬´í•œëŒ€</li>
    </ul>
  </li>
  <li>bellman-ford ì•Œê³ ë¦¬ì¦˜
    <ul>
      <li>ë…¸ë“œ 4ê°œ -&gt; for loop 3ë²ˆ
        <ul>
          <li>ëª¨ë“  edgeë“¤ì— ëŒ€í•´ì„œ relax (sì œì™¸ ëª¨ë“  ë…¸ë“œ ë¬´í•œëŒ€)
            <ul>
              <li>ë¬´í•œëŒ€ë³´ë‹¤ëŠ” ë¬´ì¡°ê±´ ë” ì§§ì€ ê²½ë¡œì´ê¸° ë•Œë¬¸ì— c = 5ë¡œ updateí•œë‹¤.</li>
              <li>e í˜¹ì€ fë¡œ ì˜¤ëŠ” ê²½ë¡œëŠ” ì—†ê¸° ë•Œë¬¸ì— ì—¬ì „íˆ ë¬´í•œëŒ€ë¡œ ë‘”ë‹¤.</li>
              <li>í˜„ì¬ ì–»ì€ distanceê°€ shortest distanceì¸ì§€ë¥¼ íŒë‹¨í•œë‹¤.</li>
              <li>c.d = 5 -&gt; shortest distance</li>
              <li>e.d, f.d ëª¨ë‘ ë” ì§§ì€ ê²½ë¡œê°€ ì¡´ì¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— negative cycleê°€ ìœ„ ê·¸ë¦¼ì—ëŠ” ì—†ë‹¤.</li>
              <li>True ë¦¬í„´ : ë‚´ê°€ ê°€ì§„ ê·¸ë˜í”„ì— negative cycleê°€ ì—†ë‹¤.</li>
              <li>ê·¸ëŸ¬ë‚˜ eì™€ fëŠ” negative cycleì´ë‹¤.</li>
              <li>ì´ ê²½ìš°ì— negative cycleì„ detect í•˜ê¸° ìœ„í•´ì„œ ì–´ë–»ê²Œ í•´ì•¼ í•˜ëŠ”ê°€?
                <ul>
                  <li>solution -&gt; ê° vertexì—ì„œ distanceë¥¼ 100ìœ¼ë¡œ ì´ˆê¸°í™”í•œë‹¤.(ì ë‹¹í•œ ê°’ìœ¼ë¡œ)</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'s': None, 'c': 's', 'e': None, 'f': None}
{'s': 0, 'c': 5, 'e': inf, 'f': inf}
</code></pre></div></div>

<p><br /></p>

<ul>
  <li>ë¬´í•œëŒ€ -&gt; 100ìœ¼ë¡œ ë°”ê¾¸ë©´ False ë¦¬í„´ìœ¼ë¡œ ë°”ë€Œì–´ ì•„ë¬´ ê°’ë„ ë‚˜ì˜¤ì§€ ì•ŠëŠ”ë‹¤.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'s': None, 'c': 's', 'e': 'f', 'f': 'e'}
{'s': 0, 'c': 5, 'e': 88, 'f': 94}
</code></pre></div></div>

<p><br /></p>

<ul>
  <li>vertexë¥¼ ëª¨ë‘ 100ìœ¼ë¡œ ì´ˆê¸°í™” í•˜ë©´</li>
  <li>cë¥¼ ë¨¼ì € relax í•˜ë©´ 5ë¡œ updateëœë‹¤.</li>
  <li>eë¥¼ relaxí•˜ë©´ fë¥¼ í†µí•´ ì˜¤ëŠ” ê²½ìš° 94ë§Œì— ì˜¬ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— update</li>
  <li>fëŠ” eë¥¼ í†µí•˜ë©´ 97 ë§Œì— ì˜¬ ìˆ˜ ìˆë‹¤.(eê°€ ë°©ê¸ˆ 94ë¡œ update ë˜ì—ˆê¸° ë•Œë¬¸ì—)</li>
  <li>cëŠ” ê·¸ëŒ€ë¡œê³  eëŠ” ê³„ì†í•´ì„œ ë‚´ë ¤ê°ˆ ê²ƒì´ê³  ì´ì— ë”°ë¼ fë„ ê³„ì†í•´ì„œ shortestê°€ update ë  ê²ƒì´ë‹¤.</li>
  <li>ê·¸ëŸ¬ë©´ ê²°ê³¼ì ìœ¼ë¡œ cëŠ” ì•„ë¬´ë¦¬ forë¬¸ì„ ëŒë ¤ë„ ê·¸ëŒ€ë¡œ ì¼ ê²ƒì´ì§€ë§Œ</li>
  <li>eëŠ” ë” ì‘ì€ shortest distanceê°€ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— Falseê°€ ë¦¬í„´ ë  ê²ƒì´ê³  negative cycleì„ detect í•  ìˆ˜ ìˆê²Œ ë˜ëŠ” ê²ƒì´ë‹¤.</li>
  <li>ì´ë¥¼ í†µí•´ ë¬´ì¡°ê±´ infë¡œ ì´ˆê¸°í™”í•˜ëŠ” ê²ƒ ë³´ë‹¤ ì¶©ë¶„íˆ í° ê°’ìœ¼ë¡œ ì´ˆê¸°í™” ì‹œí‚¤ë©´ detect í•  ìˆ˜ ìˆëŠ” ê²½ìš°ê°€ ìˆë‹¤.
    <ul>
      <li><mark>edgeì˜ ê°¯ìˆ˜ x weight ì˜ ìµœëŒ“ê°’</mark></li>
    </ul>
  </li>
</ul>

<hr />

<p>13-16</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170179208-dc36fc66-153c-4de4-a911-dd688f251c90.png" alt="image" /></p>

<p><a href="https://www.acmicpc.net/problem/1865">https://www.acmicpc.net/problem/1865</a></p>

<hr />

<p>13-17</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170179261-cd5f783a-bc54-4178-9427-773211289306.png" alt="image" /></p>

<hr />

<p>13-18</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170179271-f29f2c91-2c30-44f5-8476-8e97db1fe7ec.png" alt="image" /></p>

<p><img src="https://user-images.githubusercontent.com/79521972/172175027-eee25267-2db7-428f-b18e-5b5a95f30f82.png" alt="image" style="zoom:50%;" /><img src="https://user-images.githubusercontent.com/79521972/170915293-f8b36403-a61b-4b66-b789-1778ea2ed6c3.png" alt="image" /></p>

<p>N: vertexì˜ ê°¯ìˆ˜</p>

<p>M: edgeì˜ ê°¯ìˆ˜</p>

<p>W: negative edgeì˜ ê°¯ìˆ˜</p>

<p>Sì™€ Eê°€ undirected ì´ì–´ì¡Œë‹¤.</p>

<p>M+2 ë²ˆì§¸ ì¤„ ë¶€í„°ëŠ” Sê°€ ì‹œì‘, Eê°€ ë„ì°©ì´ ëœë‹¤. TëŠ” negative edge</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sys</span>


<span class="k">def</span> <span class="nf">bellman_ford</span><span class="p">(</span><span class="n">start</span><span class="p">):</span>  <span class="c1"># 1
</span>    <span class="n">dist</span><span class="p">[</span><span class="n">start</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="nb">next</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">road</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">dist</span><span class="p">[</span><span class="nb">next</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">dist</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">time</span><span class="p">:</span>
                    <span class="n">dist</span><span class="p">[</span><span class="nb">next</span><span class="p">]</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">+</span> <span class="n">time</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">N</span><span class="p">:</span>
                        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>


<span class="n">sys</span><span class="p">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'bj1865_in.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
<span class="nb">input</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">readline</span>

<span class="n">tc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tc</span><span class="p">):</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">())</span>
    <span class="n">road</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[</span><span class="n">M</span> <span class="o">*</span> <span class="mi">10</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
        <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">readline</span><span class="p">().</span><span class="n">split</span><span class="p">())</span>
        <span class="n">road</span><span class="p">[</span><span class="n">S</span><span class="p">].</span><span class="n">append</span><span class="p">([</span><span class="n">E</span><span class="p">,</span> <span class="n">T</span><span class="p">])</span>
        <span class="n">road</span><span class="p">[</span><span class="n">E</span><span class="p">].</span><span class="n">append</span><span class="p">([</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">W</span><span class="p">):</span>
        <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">readline</span><span class="p">().</span><span class="n">split</span><span class="p">())</span>
        <span class="n">road</span><span class="p">[</span><span class="n">S</span><span class="p">].</span><span class="n">append</span><span class="p">([</span><span class="n">E</span><span class="p">,</span> <span class="o">-</span><span class="n">T</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">bellman_ford</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"YES"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"NO"</span><span class="p">)</span>
<span class="n">tc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tc</span><span class="p">):</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">W</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">())</span>
    <span class="n">road</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
    
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
        <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">readline</span><span class="p">().</span><span class="n">split</span><span class="p">())</span>
        <span class="n">road</span><span class="p">[</span><span class="n">S</span><span class="p">].</span><span class="n">append</span><span class="p">([</span><span class="n">E</span><span class="p">,</span> <span class="n">T</span><span class="p">])</span>
        <span class="n">road</span><span class="p">[</span><span class="n">E</span><span class="p">].</span><span class="n">append</span><span class="p">([</span><span class="n">S</span><span class="p">,</span> <span class="n">T</span><span class="p">])</span>
    <span class="c1">#for 
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NO
YES
</code></pre></div></div>

<p>dictionaryë¡œ í•˜ë©´ ì•ˆë˜ëŠ” ì´ìœ ? -&gt; ê°•ì˜ ë³´ê³  ì ê¸° (keyê°€ stringì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì—)</p>

<p>ì´ì°¨ì› ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥ - vertex ê°¯ìˆ˜ + 1</p>

<p>ì´ˆê¸°í™”í•  ë•Œ ê°’ì„ ë¬´í•œëŒ€ë¡œ í•˜ë©´ ì•ˆë˜ê³ </p>

<ul>
  <li>edgeì˜ ê°¯ìˆ˜ x weight ì˜ ìµœëŒ“ê°’</li>
</ul>

<hr />

<p>13-19</p>

<h2 id="243-dijkstras-algorithm">24.3 Dijkstraâ€™s algorithm</h2>

<p><img src="https://user-images.githubusercontent.com/79521972/170179459-b74b4a5b-9fb0-4064-ae55-b57ea87096d4.png" alt="image" /></p>

<ul>
  <li>
    <p>Bellman-Ford ì™€ ë§ˆì°¬ê°€ì§€ë¡œ single-source shortest-pathsë¥¼ êµ¬í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.</p>
  </li>
  <li><strong>í•˜ì§€ë§Œ ë‹¤ë¥¸ ì ì€ ëª¨ë“  edgeì˜ weightê°€ non-negativeì´ë‹¤.</strong>
    <ul>
      <li>w(u, v) &gt;= 0</li>
    </ul>
  </li>
  <li>ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜ì€ ë²¨ë§Œí¬ë“œë³´ë‹¤ running time ì´ ë¹ ë¥´ë‹¤.</li>
</ul>

<p><br /></p>

<ul>
  <li>ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜ì€ set Së¥¼ ìœ ì§€í•œë‹¤.
    <ul>
      <li>sourceë¶€í„°ì˜ shortest pathê°€ ì´ë¯¸ ê²°ì •ëœ vertexì˜ ì§‘í•©</li>
      <li>ì•Œê³ ë¦¬ì¦˜ì„ ëŒë¦¬ë‹¤ ë³´ë©´ ì´ set Sì— í•œë†ˆì”© ì¶”ê°€ê°€ ë˜ê³ </li>
      <li>ì•Œê³ ë¦¬ì¦˜ì´ ëë‚˜ë©´ ëª¨ë“  vertexê°€ set Sì— ë“¤ì–´ê°€ê²Œ ëœë‹¤.</li>
    </ul>
  </li>
  <li>ì•Œê³ ë¦¬ì¦˜ì„ ëŒë¦¬ë©´ì„œ ì•„ë˜ì™€ ê°™ì€ ë‘ ê°€ì§€ ë™ì‘ì„ ë°˜ë³µí•œë‹¤.
    <ul>
      <li>
        <ol>
          <li><strong>select</strong>: sourceë¶€í„°ì˜ distanceê°€ í˜„ì¬ê¹Œì§€ ê°€ì¥ ì‘ì€ ì• ë¥¼ ì„ íƒí•œë‹¤. -&gt; ì–˜ê°€ set Sì— ì¶”ê°€ ë¨</li>
        </ol>
      </li>
      <li>
        <ol>
          <li><strong>relax</strong> (update): uê°€ 1ë²ˆì—ì„œ ê³ ë¥¸ vertexì¸ë° ì—¬ê¸°ì„œ ì¶œë°œí•˜ëŠ” ëª¨ë“  vertexë¥¼ ë‹¤ì‹œ relax í•œë‹¤.</li>
        </ol>
      </li>
    </ul>
  </li>
  <li>ìœ„ loopê°€ ëë‚˜ë©´ ëª¨ë“  vertexì— ëŒ€í•´ì„œ relaxê°€ ëë‚˜ìˆê²Œ ëœë‹¤.</li>
</ul>

<hr />

<p>13-20</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170179478-68e858a2-56ed-415a-a0a9-65f3b2251382.png" alt="image" /></p>

<ul>
  <li>vertexê°€ 5ê°œ ìˆëŠ”ë° ëª¨ë“  vertexì˜ sì™€ì˜ distanceëŠ” ë¬´í•œëŒ€ë¡œ ì´ˆê¸°í™”í•œë‹¤.</li>
  <li>loop
    <ul>
      <li>select:
        <ul>
          <li>ê°€ì¥ ì‘ì€ distanceëŠ” sì´ê¸° ë•Œë¬¸ì— sê°€ selectì— ë“¤ì–´ê°„ë‹¤.</li>
        </ul>
      </li>
      <li>tì™€ yì— ëŒ€í•´ relax ì§„í–‰
        <ul>
          <li>t: së¥¼ í†µí•´ì„œ ê°€ëŠ” ê²½ìš° 10ë§Œì— ê°ˆ ìˆ˜ ìˆìœ¼ë‹ˆ 10ìœ¼ë¡œ update</li>
          <li>y: së¥¼ í†µí•´ì„œ ê°€ëŠ” ê²½ìš° 5ë§Œì— ê°ˆ ìˆ˜ ìˆìœ¼ë‹ˆ 10ìœ¼ë¡œ update</li>
        </ul>
      </li>
      <li>ì´ ê³¼ì •ì´ ëë‚˜ê³  distanceê°€ ê°€ì¥ ì‘ì€ yê°€ set Sì— ë“¤ì–´ê°„ë‹¤.</li>
      <li>yì™€ ê°€ê¹Œìš´ t, x,zì— ëŒ€í•´ relax
        <ul>
          <li>t: yë¥¼ í†µí•´ 8 ë§Œì— ê°€ëŠ” ê²ƒìœ¼ë¡œ update</li>
          <li>x: yë¥¼ í†µí•´ 14 ë§Œì— ê°€ëŠ” ê²ƒìœ¼ë¡œ update</li>
          <li>z: yë¥¼ í†µí•´ 7 ë§Œì— ê°€ëŠ” ê²ƒìœ¼ë¡œ update</li>
        </ul>
      </li>
      <li>ë˜ ë‚¨ì€ ì• ë“¤(s, yì œì™¸; set Sì— ì—†ëŠ” ì• ë“¤ ì¤‘ì—ì„œ) ì¤‘ì—ì„œ ì œì¼ ì‘ì€ì•  set Sì— ë„£ëŠ”ë‹¤. -&gt; z
        <ul>
          <li>x -&gt; 13ìœ¼ë¡œ update</li>
        </ul>
      </li>
      <li>set Sì— t ëŒ€ì…
        <ul>
          <li>x -&gt; 9ë¡œ update</li>
        </ul>
      </li>
      <li>set Sì— x ëŒ€ì… (ë‚¨ì€ ê²ƒì´ xë°–ì— ì—†ìŒ)
        <ul>
          <li>update ì‚¬í•­ ì—†ìŒ</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>ì´ ê²½ìš° distanceê°€ ê°€ì¥ ì‘ì€ ì• ë¥¼ update í–ˆëŠ”ë° ë§Œì•½ì— distanceê°€ ê°™ì€ ì• ë“¤ë¼ë¦¬ ìˆìœ¼ë©´ ì–´ë–»ê²Œ í•¨?
    <ul>
      <li>ë­˜ ë¨¼ì € í•´ë„ ìƒê´€ ì—†ì§€ë§Œ -&gt; ë˜ë„ë¡(ë¬´ì¡°ê±´ ì´ë ‡ê²Œ í•´ë¼) ì•ŒíŒŒë²³ ìˆœì„œëŒ€ë¡œ í•œë‹¤.</li>
    </ul>
  </li>
  <li>undirectedë¡œ ë˜ì–´ìˆëŠ” ê²½ìš°?
    <ul>
      <li>ëª¨ë“  ë°©í–¥ì„ ë‹¤ ê³ ë ¤í•˜ì—¬ì„œ</li>
      <li>undirectë¼ê³  ë‹¤ë¥¼ ê²ƒì€ ì—†ë‹¤. ê¸°ë³¸ì ì¸ algorithmì€ ê·¸ëŒ€ë¡œì´ë‹¤.(select, relax)</li>
    </ul>
  </li>
</ul>

<hr />

<p>13-21</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170179529-5d54aa9f-299c-42ba-800d-1f392bd27683.png" alt="image" /></p>

<ul>
  <li>
    <p>(bellman-fordì™€ ìœ ì‚¬í•˜ê²Œ) ëª¨ë“  vertexë¥¼ initialize</p>
  </li>
  <li>set S = ì„ ì–¸ ë° ì´ˆê¸°í™”</li>
  <li>í˜„ì¬ ê¹Œì§€ distanceê°€ ì œì¼ ì‘ì€ ì• ë¥¼ ì•Œì•„ë‚´ê¸° ìœ„í•´ì„œ min heapì„ ì‚¬ìš©í•œë‹¤.(key = v.d)
    <ul>
      <li>Q : min heap</li>
    </ul>
  </li>
  <li>heap êµ¬ì¡°ì—ì„œ popì„ í•˜ë©´ ì œì¼ ì‘ì€ ì• ê°€ ë‚˜ì˜¨ë‹¤.</li>
  <li>Qì— ë‚¨ì€ ì›ì†Œê°€ ì—†ì„ ë•Œê¹Œì§€ loopë¥¼ ëŒë¦°ë‹¤.
    <ul>
      <li>loopë¥¼ ëŒë¦¬ë©´ì„œ Qì—ì„œ í•˜ë‚˜ì”© popì„ í•˜ê³  ì´ë¥¼ set Sì— ë„£ê³ </li>
    </ul>
  </li>
</ul>

<p><br /></p>

<ul>
  <li>ìœ„ pseudo codeë¥¼ ê·¸ëŒ€ë¡œ ì“¸ ìˆ˜ ì—†ëŠ” ì´ìœ 
    <ul>
      <li>íì— distanceì™€ vertex nameì„ ë¬¶ì€ ì •ë³´ê°€ ì­‰ ì €ì¥í•  ê²ƒì¸ë°</li>
    </ul>
  </li>
</ul>

<p>while loopì•ˆ for ë¬¸ ì•ˆì—ì„œ relaxë¥¼ ì§„í–‰í•˜ëŠ”ë° relaxëŠ” vertex ë‹¹ í•œ ë²ˆë§Œ ì§„í–‰í•œë‹¤.</p>

<hr />

<p>13-22</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170179561-e858130c-3d9b-421b-bf6b-31dbb9615c50.png" alt="image" /></p>

<ul>
  <li>ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜ì€ ì¼ì¢…ì˜ ê·¸ë¦¬ë”” ì•Œê³ ë¦¬ì¦˜ì— í•´ë‹¹ ëœë‹¤.
    <ul>
      <li>í˜„ì¬ê¹Œì§€ ì•Œë ¤ì§„ ê²ƒ ì¤‘ì— ê°€ì¥ ì‘ì€ ë…¸ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§„í–‰ë˜ì–´ ìµœì„ ì˜ ì„ íƒì„ í•˜ê¸° ë•Œë¬¸ì— ê·¸ë ‡ë‹¤.</li>
      <li>ì´ ê²½ìš° í•­ìƒ global optimumì´ êµ¬í•´ì§€ëŠ”ê°€? -&gt; ê·¸ë ‡ë‹¤ í•˜ì§€ë§Œ ì¦ëª…ì´ êµ‰ì¥íˆ ë³µì¡í•˜ë‹¤.</li>
    </ul>
  </li>
  <li>time complexity
    <ul>
      <li>5ë²ˆ ì¤„: O(VlogV)</li>
      <li>7,8ë²ˆ: O(ElogV)</li>
      <li>ë”°ë¼ì„œ O(VlogV + ElogV) ì¸ë° V &gt;= Eì´ê¸° ë•Œë¬¸ì—</li>
      <li>ìµœì¢…ì ì¸ ë‹¤ìµìŠ¤íŠ¸ë¼ ì•Œê³ ë¦¬ì¦˜ì˜ time complexityëŠ”
        <ul>
          <li>O(ElogV)</li>
        </ul>
      </li>
      <li>(ì•ì˜ ë²¨ë§Œí¬ë“œëŠ” O(EV))</li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="ì‹œí—˜-ë²”ìœ„x">ì‹œí—˜ ë²”ìœ„(X)</h2>

<p>13-23</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">heapq</span> <span class="kn">import</span> <span class="n">heappop</span><span class="p">,</span> <span class="n">heappush</span> <span class="c1"># 1
</span><span class="kn">import</span> <span class="nn">math</span>


<span class="k">def</span> <span class="nf">dijkstra</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
    <span class="c1"># initialize
</span>    <span class="n">distance</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">predecessor</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">grpah</span><span class="p">.</span><span class="n">keys</span><span class="p">():</span> <span class="c1"># 9
</span>        <span class="n">distance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">inf</span>
        <span class="n">predecessor</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">distance</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="n">selected</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>		<span class="c1"># the set S
</span>    <span class="n">min_q</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">source</span><span class="p">)]</span>	<span class="c1"># (distance from source, vertex name)
</span>    
    <span class="k">while</span> <span class="n">min_q</span><span class="p">:</span> <span class="c1"># 17
</span>        <span class="c1"># u is selected and added to the set S
</span>        <span class="n">distance_u</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">heappop</span><span class="p">(</span><span class="n">min_q</span><span class="p">)</span>
        <span class="n">selected</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        
        <span class="c1"># w is the weight of edge (u, v)
</span>        <span class="c1"># relax (u, v), if v is not selected
</span>        <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">graph</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">items</span><span class="p">():</span> <span class="c1"># 24
</span>            <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">selected</span><span class="p">:</span> <span class="c1"># selectedê°€ ì•ˆ ëœ ì• ë“¤ì˜ ê²½ìš°ì—ë§Œ relax
</span>                <span class="k">if</span> <span class="n">distance</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">distance</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">:</span>
                    <span class="n">distance</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span>
                    <span class="n">predecessor</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span>
                    <span class="n">heappush</span><span class="p">(</span><span class="n">min_q</span><span class="p">,</span> <span class="p">(</span><span class="n">distance</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="n">v</span><span class="p">))</span> <span class="c1">#updateí•œ ì •ë³´ë¥¼ ë‹¤ì‹œ qì— ë„£ëŠ”ë‹¤.
</span>                    
	<span class="k">return</span> <span class="n">distance</span><span class="p">,</span> <span class="n">predecessor</span> <span class="c1"># 31
</span>

<span class="n">Fig24_6</span> <span class="o">=</span> <span class="p">{</span> <span class="c1"># 34
</span>    <span class="s">'s'</span><span class="p">:</span> <span class="p">{</span><span class="s">'t'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'y'</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
    <span class="s">'t'</span><span class="p">:</span> <span class="p">{</span><span class="s">'x'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'y'</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="s">'x'</span><span class="p">:</span> <span class="p">{</span><span class="s">'z'</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
    <span class="s">'y'</span><span class="p">:</span> <span class="p">{</span><span class="s">'t'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">'x'</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s">'z'</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="s">'z'</span><span class="p">:</span> <span class="p">{</span><span class="s">'s'</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s">'x'</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>
<span class="p">}</span>
<span class="n">dist</span><span class="p">,</span> <span class="n">pre</span> <span class="o">=</span> <span class="n">dijkstra</span><span class="p">(</span><span class="n">Fig24_6</span><span class="p">,</span> <span class="s">'s'</span><span class="p">)</span> <span class="c1"># 41
</span><span class="k">print</span><span class="p">(</span><span class="n">pre</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'s': None, 't': 's', 'x': None, 'y': 's', 'z': None}
{'s': 0, 't': 10, 'x': inf, 'y': 5, 'z': inf}
</code></pre></div></div>

<p>node ì´ë¦„ì´ stringìœ¼ë¡œ ë˜ì–´ìˆê¸° ë•Œë¬¸ì— setìœ¼ë¡œ í•œ ê²ƒ</p>

<p>integerì´ë©´ ìë™ìœ¼ë¡œ indexê°€ ë¶™ê¸° ë•Œë¬¸ì— ê·¸ëƒ¥ ë¦¬ìŠ¤íŠ¸ë¡œ í•˜ì—¬ ë©”ëª¨ë¦¬ë¥¼ ì ˆì•½ + ì†ë„ ì¦ê°€</p>

<hr />

<p>13-25</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170180173-cbadecdc-24eb-437a-b587-617aac438db1.png" alt="image" /></p>

<p><a href="https://www.acmicpc.net/problem/1753">https://www.acmicpc.net/problem/1753</a></p>

<p>ë¹¨ê°„ì¤„ì˜ ì˜ë¯¸ëŠ” ë”•ì…”ë„ˆë¦¬ë³´ë‹¤ ë¦¬ìŠ¤íŠ¸ë¡œ í•˜ëŠ” ê²ƒì´ ë” ìœ ë¦¬í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œë ¤ì£¼ëŠ” ì •ë³´ì´ë‹¤.</p>

<hr />

<p>13-26</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170180212-b7275480-402f-46c9-8423-7b7445c633a8.png" alt="image" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">dijkstra</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
    <span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="p">.</span><span class="n">inf</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">num</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">distance</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="n">selected</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">num</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">min_q</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">source</span><span class="p">)]</span>
    
</code></pre></div></div>

<p>set Sì— ë“¤ì–´ê°€ë©´ selectedê°€ True ê°€ ëœë‹¤.</p>

<p>0.0ì¸ ì´ìœ ëŠ” infê°€ floatì´ê¸° ë•Œë¬¸ì— typeì„ ë§ì¶°ì£¼ê¸° ìœ„í•¨.</p>

<hr />

<p>13-27</p>

<h2 id="224-topological-sort">22.4 Topological sort</h2>

<p><img src="https://user-images.githubusercontent.com/79521972/170180400-cfbc2b07-0b49-4890-ac49-e9d34a02b603.png" alt="image" /></p>

<hr />

<p>13-28</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170180433-a38cff03-10d3-4b09-ba0f-1c3b282aa3e5.png" alt="image" /></p>

<hr />

<p>13-29</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collection</span> <span class="kn">import</span> <span class="n">deque</span> <span class="c1"># 1
</span><span class="kn">import</span> <span class="nn">sys</span>

<span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s">'undershorts'</span><span class="p">,</span> <span class="s">'pants'</span><span class="p">,</span> <span class="s">'belt'</span><span class="p">,</span> <span class="s">'shirt'</span><span class="p">,</span> <span class="s">'tie'</span><span class="p">,</span> <span class="s">'jacket'</span><span class="p">,</span> <span class="s">'socks'</span><span class="p">,</span>
        <span class="s">'shoes'</span><span class="p">,</span> <span class="s">'watch'</span><span class="p">]</span>
<span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

<span class="c1"># adjacency list # 8
</span><span class="n">graph</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[]]</span>

<span class="c1"># compute indegree of each node
</span><span class="n">indegree</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">num</span> <span class="c1"># 12
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">graph</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
        <span class="n">indegree</span><span class="p">[</span><span class="n">graph</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
        
<span class="c1"># enqueue the nodes of degree 0 
</span><span class="n">q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span> <span class="c1"># 18
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">indegree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">q</span><span class="p">.</span><span class="n">append</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        
<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># 23
</span>    <span class="n">i</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">popleft</span><span class="p">()</span>	<span class="c1"># process a node(item)
</span>    <span class="k">print</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
	<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">graph</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span> <span class="c1"># process adjacent nodes
</span>        <span class="n">adj</span> <span class="o">=</span> <span class="n">graph</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="c1"># 28
</span>        <span class="n">indegree</span><span class="p">[</span><span class="n">adj</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">indegree</span><span class="p">[</span><span class="n">adj</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">q</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>
</code></pre></div></div>

<hr />

<p>13-31</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170181007-23fef67c-c06d-49e0-b153-f335c16d5a5e.png" alt="image" /></p>

<hr />

<p>13-32</p>

<p><img src="https://user-images.githubusercontent.com/79521972/170181025-9c7fa3b5-55a1-464c-b3f0-6804968efbfa.png" alt="image" /></p>

<p><a href="https://www.acmicpc.net/problem/2252">https://www.acmicpc.net/problem/2252</a></p>

<hr />

<p>13-33</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span> <span class="c1"># 1
</span><span class="kn">import</span> <span class="nn">sys</span>

<span class="n">sys</span><span class="p">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'bj2252.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
<span class="n">N</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">().</span><span class="n">split</span><span class="p">())</span>

<span class="c1"># build the adjacency list # 7
</span><span class="n">graph</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="n">readling</span><span class="p">().</span><span class="n">split</span><span class="p">())</span>
    <span class="n">graph</span><span class="p">[</span><span class="n">a</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    
<span class="c1"># compute indegree of each node # 13
</span></code></pre></div></div>

:ET